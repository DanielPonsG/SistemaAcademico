{% extends "index_master.html" %}

{% block content %}
<div class="right_col" role="main">
  <div class="container-fluid">
    
    {% if es_alumno %}
    {% if error_curso %}
    <div class="student-alert student-alert--warning">
      <i class="fas fa-exclamation-triangle"></i>
      <h2>Sin curso asignado</h2>
      <p>{{ error_curso }}</p>
      <a href="{% url 'inicio' %}" class="btn btn-primary btn-sm">
        <i class="fas fa-home me-1"></i>Volver al inicio
      </a>
    </div>
    {% elif error_horarios %}
    <div class="student-alert student-alert--danger">
      <i class="fas fa-times-circle"></i>
      <h2>No fue posible cargar tus horarios</h2>
      <p>{{ error_horarios }}</p>
      <a href="{% url 'inicio' %}" class="btn btn-primary btn-sm">
        <i class="fas fa-home me-1"></i>Volver al inicio
      </a>
    </div>
    {% else %}
    <div class="student-schedule fade-in">
      <section class="student-schedule-hero">
        <div class="student-schedule-hero__header">
          <div class="student-schedule-hero__icon"><i class="fas fa-calendar-week"></i></div>
          <div>
            <span class="student-schedule-hero__chip"><i class="fas fa-user-graduate"></i> Vista alumno</span>
            <h1 class="student-schedule-hero__title">Mi horario de clases</h1>
            <p class="student-schedule-hero__subtitle">Coordina tus jornadas y mantén tus bloques bajo control.</p>
            <div class="student-schedule-hero__meta">
              <span><i class="fas fa-school"></i>{{ curso_actual }}</span>
              <span><i class="fas fa-user-tie"></i>{% if curso_actual.profesor_jefe %}{{ curso_actual.profesor_jefe.get_nombre_completo }}{% else %}Profesor jefe no asignado{% endif %}</span>
              <span><i class="fas fa-clock"></i>{% if primer_bloque and ultimo_bloque %}{{ primer_bloque|time:"H:i" }} - {{ ultimo_bloque|time:"H:i" }}{% else %}Sin bloques{% endif %}</span>
            </div>
          </div>
        </div>
        <div class="student-schedule-hero__aside">
          <div class="student-schedule-hero__time" id="studentScheduleClock"></div>
          <div class="student-schedule-hero__metrics">
            <article class="student-metric">
              <span>Clases semanales</span>
              <strong>{{ total_clases_semana }}</strong>
            </article>
            <article class="student-metric">
              <span>Horas semanales</span>
              <strong>{{ horas_totales_semana }}</strong>
              <small>hrs</small>
            </article>
            <article class="student-metric">
              <span>Días con clases</span>
              <strong>{{ dias_con_clases }}</strong>
            </article>
            <article class="student-metric">
              <span>Asignaturas activas</span>
              <strong>{{ asignaturas_curso|length }}</strong>
            </article>
          </div>
        </div>
      </section>

      <section class="student-schedule-section">
        <header class="student-schedule-section__header">
          <div>
            <h2>Panorama semanal</h2>
            <p>Visualiza los días con mayor carga académica.</p>
          </div>
        </header>
        <div class="student-week-grid">
          {% for dia in dias_semana_display %}
          <article class="student-week-card{% if dia.es_hoy %} is-today{% endif %}">
            <header>
              <span>{{ dia.nombre }}</span>
              <small>{{ dia.abreviado }}</small>
            </header>
            <strong>{{ dia.total }}</strong>
            <span>bloque{{ dia.total|pluralize:",s" }}</span>
          </article>
          {% endfor %}
        </div>
      </section>

      <section class="student-schedule-section">
        <header class="student-schedule-section__header">
          <div>
            <h2>Próximas clases</h2>
            <p>Agenda inmediata para que no pierdas ningún bloque.</p>
          </div>
        </header>
        {% if proximas_clases_estudiante %}
        <div class="student-upcoming-grid">
          {% for clase in proximas_clases_estudiante %}
          <article class="student-upcoming-card{% if clase.es_hoy %} is-today{% endif %}">
            <div class="student-upcoming-card__head">
              <span>{{ clase.dia_nombre }}</span>
              <small>{{ clase.fecha|date:"d M" }}</small>
            </div>
            <div class="student-upcoming-card__time">{{ clase.hora_inicio|time:"H:i" }} - {{ clase.hora_fin|time:"H:i" }}</div>
            <div class="student-upcoming-card__subject">{{ clase.asignatura.nombre|default:"Sin asignatura" }}</div>
            {% if clase.profesor %}
            <small class="student-upcoming-card__teacher"><i class="fas fa-user me-1"></i>{{ clase.profesor.get_nombre_completo }}</small>
            {% endif %}
          </article>
          {% endfor %}
        </div>
        {% else %}
        <div class="student-empty-state">
          <i class="fas fa-calendar-check"></i>
          <p>No tienes clases próximas registradas.</p>
        </div>
        {% endif %}
      </section>

      <section class="student-schedule-section">
        <header class="student-schedule-section__header">
          <div>
            <h2>Horario semanal completo</h2>
            <p>Revisa todos tus bloques organizados por jornada.</p>
          </div>
        </header>
        {% if horario_semanal_matriz %}
        <div class="student-schedule-table-wrapper">
          <table class="table tabla-horarios-detallada student-schedule-table">
            <thead>
              <tr>
                <th class="hora-columna text-center"><i class="fas fa-clock me-1"></i>Bloque</th>
                {% for dia in dias_semana_display %}
                <th class="text-center dia-columna{% if dia.es_hoy %} horario-dia-actual{% endif %}" data-dia="{{ dia.codigo }}">
                  <div class="dia-header">
                    <div class="dia-nombre">{{ dia.nombre }}</div>
                    <small class="dia-codigo">{{ dia.abreviado }}</small>
                  </div>
                </th>
                {% endfor %}
              </tr>
            </thead>
            <tbody>
              {% for fila in horario_semanal_matriz %}
              <tr>
                <td class="hora-columna text-center">
                  <div class="hora-bloque">
                    <div>{{ fila.hora_inicio|time:"H:i" }}</div>
                    <small class="text-muted">{{ fila.hora_fin|time:"H:i" }}</small>
                  </div>
                </td>
                {% for dia_codigo in dias_semana %}
                <td class="horario-cell student-schedule-cell{% if dia_codigo == dia_actual_codigo %} horario-dia-actual-celda{% endif %}" data-dia="{{ dia_codigo }}">
                  {% for clase_dia, clase_obj in fila.clases.items %}
                    {% if clase_dia == dia_codigo and clase_obj %}
                    <div class="student-schedule-slot">
                      <strong>{{ clase_obj.asignatura.nombre|default:"Sin asignatura" }}</strong>
                      {% if clase_obj.asignatura.profesor_responsable %}
                      <small>{{ clase_obj.asignatura.profesor_responsable.get_nombre_completo }}</small>
                      {% endif %}
                    </div>
                    {% elif clase_dia == dia_codigo %}
                    <div class="student-schedule-slot student-schedule-slot--empty">
                      <i class="fas fa-minus"></i>
                    </div>
                    {% endif %}
                  {% endfor %}
                </td>
                {% endfor %}
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <div class="student-schedule-table-actions">
          <div class="student-schedule-legend">
            <span><span class="legend-dot legend-dot--class"></span>Clase programada</span>
            <span><span class="legend-dot legend-dot--empty"></span>Horario libre</span>
          </div>
          <div class="student-schedule-actions">
            <button type="button" class="btn btn-outline-primary btn-sm" onclick="imprimirHorario()">
              <i class="fas fa-print me-1"></i>Imprimir
            </button>
            <a href="{% url 'mi_curso' %}" class="btn btn-primary btn-sm">
              <i class="fas fa-users me-1"></i>Ver mi curso
            </a>
          </div>
        </div>
        {% else %}
        <div class="student-empty-state">
          <i class="fas fa-calendar-times"></i>
          <p>Tu curso aún no tiene bloques asignados.</p>
        </div>
        {% endif %}
      </section>

      <section class="student-schedule-section">
        <header class="student-schedule-section__header">
          <div>
            <h2>Asignaturas y docentes</h2>
            <p>Distribución de bloques por materia y profesor responsable.</p>
          </div>
        </header>
        {% if asignaturas_resumen %}
        <div class="student-subject-grid">
          {% for asignatura in asignaturas_resumen %}
          <article class="student-subject-card">
            <div class="student-subject-card__header">
              <strong>{{ asignatura.nombre }}</strong>
              {% if asignatura.codigo %}<span class="student-subject-card__code">{{ asignatura.codigo }}</span>{% endif %}
            </div>
            <p class="student-subject-card__meta">
              {{ asignatura.bloques }} bloque{{ asignatura.bloques|pluralize:",s" }}
              {% if total_clases_semana %}<span>{{ asignatura.porcentaje }}%</span>{% endif %}
            </p>
            {% if asignatura.profesor %}
            <small class="text-muted d-block"><i class="fas fa-user me-1"></i>{{ asignatura.profesor.get_nombre_completo }}</small>
            {% endif %}
            <div class="student-subject-card__progress"><span style="width: {{ asignatura.porcentaje }}%;"></span></div>
          </article>
          {% endfor %}
        </div>
        {% else %}
        <div class="student-empty-state">
          <i class="fas fa-book"></i>
          <p>No hay asignaturas vinculadas a tu horario.</p>
        </div>
        {% endif %}
      </section>

      <section class="student-schedule-section">
        <header class="student-schedule-section__header">
          <div>
            <h2>Accesos directos</h2>
            <p>Ingresa rápidamente a las vistas asociadas a tu curso.</p>
          </div>
        </header>
        <div class="student-quick-grid">
          <a href="{% url 'ver_notas_curso' %}" class="student-quick-card" style="background: linear-gradient(135deg, #2563eb, #1d4ed8);">
            <i class="fas fa-chart-line"></i>
            <strong>Mis notas</strong>
            <small>Revisa tus últimas evaluaciones.</small>
          </a>
          <a href="{% url 'ver_asistencia_alumno' %}" class="student-quick-card" style="background: linear-gradient(135deg, #10b981, #047857);">
            <i class="fas fa-user-check"></i>
            <strong>Mi asistencia</strong>
            <small>Monitorea tus registros diarios.</small>
          </a>
          <a href="{% url 'libro_anotaciones' %}" class="student-quick-card" style="background: linear-gradient(135deg, #f97316, #ea580c);">
            <i class="fas fa-sticky-note"></i>
            <strong>Anotaciones</strong>
            <small>Consulta observaciones importantes.</small>
          </a>
          <a href="{% url 'mi_curso' %}" class="student-quick-card" style="background: linear-gradient(135deg, #7c3aed, #5b21b6);">
            <i class="fas fa-users"></i>
            <strong>Mi curso</strong>
            <small>Resumen completo de tu curso.</small>
          </a>
        </div>
      </section>
    </div>
    {% endif %}
    
    {% elif es_profesor %}
    <div class="prof-schedule">
      <section class="prof-schedule-card prof-schedule-hero">
        <div class="prof-schedule-hero__content">
          <div class="prof-schedule-hero__icon">
            <i class="fas fa-chalkboard-teacher"></i>
          </div>
          <div>
            <h1 class="prof-schedule-hero__title">Mis horarios</h1>
            <p class="prof-schedule-hero__subtitle">Organiza tus clases del {{ anio_actual|default:"año en curso" }}.</p>
            <div class="prof-schedule-hero__meta">
              <span><i class="fas fa-user-tie"></i>{{ profesor.get_nombre_completo|default:user.get_full_name }}</span>
              <span><i class="fas fa-school"></i>{{ total_cursos|default:"0" }} curso{{ total_cursos|default:0|pluralize:",s" }}</span>
            </div>
            <div class="prof-schedule-hero__time" id="currentDateTimeProfesor"></div>
          </div>
        </div>
        <div class="prof-schedule-hero__metrics">
          <div class="prof-schedule-metric">
            <span>Asignaturas activas</span>
            <strong>{{ total_asignaturas|default:"0" }}</strong>
          </div>
          <div class="prof-schedule-metric">
            <span>Horas semanales</span>
            <strong>{{ total_horas_semanales|default:"0" }}</strong>
          </div>
          <div class="prof-schedule-metric">
            <span>Estudiantes</span>
            <strong>{{ total_estudiantes|default:"0" }}</strong>
          </div>
        </div>
      </section>

      {% if error_horarios %}
      <section class="prof-schedule-card prof-schedule-empty">
        <i class="fas fa-times-circle"></i>
        <h2>Sin horario disponible</h2>
        <p>{{ error_horarios }}</p>
        <a href="{% url 'inicio' %}" class="btn btn-primary btn-sm"><i class="fas fa-home me-1"></i>Volver al panel</a>
      </section>
      {% elif error_profesor %}
      <section class="prof-schedule-card prof-schedule-empty">
        <i class="fas fa-exclamation-triangle"></i>
        <h2>Información incompleta</h2>
        <p>{{ error_profesor }}</p>
        <a href="{% url 'inicio' %}" class="btn btn-primary btn-sm"><i class="fas fa-home me-1"></i>Volver al panel</a>
      </section>
      {% elif not asignaturas_profesor %}
      <section class="prof-schedule-card prof-schedule-empty">
        <i class="fas fa-calendar-times"></i>
        <h2>No tienes asignaturas asignadas</h2>
        <p>Cuando se te asignen clases aparecerán aquí tus bloques y recordatorios.</p>
        <a href="{% url 'inicio' %}" class="btn btn-primary btn-sm"><i class="fas fa-home me-1"></i>Volver al panel</a>
      </section>
      {% else %}

      <div class="prof-schedule-grid">
        <div class="prof-schedule-main">
          <section class="prof-schedule-card">
            <header class="prof-schedule-card__header">
              <div>
                <h2>Horario semanal</h2>
                <p>Bloques por jornada y día para todas tus asignaturas.</p>
              </div>
              <div class="prof-schedule-card__actions">
                <button type="button" class="btn btn-outline-primary btn-sm" onclick="imprimirHorario()">
                  <i class="fas fa-print me-1"></i>Imprimir
                </button>
              </div>
            </header>

            {% if horario_semanal_matriz %}
            <div class="table-responsive prof-schedule-table">
              <table class="table tabla-horarios-detallada">
                <thead>
                  <tr>
                    <th class="hora-columna text-center">
                      <i class="fas fa-clock me-1"></i>Horario
                    </th>
                    {% for dia in dias_semana_display %}
                    <th class="dia-columna" data-dia="{{ dia.codigo }}">
                      <div class="dia-header">
                        <div class="dia-nombre">{{ dia.nombre }}</div>
                        <small class="dia-codigo">{{ dia.codigo }}</small>
                      </div>
                    </th>
                    {% endfor %}
                  </tr>
                </thead>
                <tbody>
                  {% for fila in horario_semanal_matriz %}
                  <tr>
                    <td class="hora-columna text-center fw-bold">
                      <div class="hora-bloque">
                        <div>{{ fila.hora_inicio|time:"H:i" }}</div>
                        <small class="text-muted">{{ fila.hora_fin|time:"H:i" }}</small>
                      </div>
                    </td>
                    {% for dia in dias_semana_display %}
                    <td class="horario-cell text-center" data-dia="{{ dia.codigo }}">
                      {% for clase_dia, clase_obj in fila.clases.items %}
                        {% if clase_dia == dia.codigo and clase_obj %}
                        <div class="prof-schedule-slot">
                          <span class="prof-schedule-slot__subject">{{ clase_obj.asignatura.nombre|default:"Sin asignatura" }}</span>
                          <span class="prof-schedule-slot__course">{{ clase_obj.curso.nombre }}</span>
                        </div>
                        {% elif clase_dia == dia.codigo %}
                        <div class="prof-schedule-slot prof-schedule-slot--empty">
                          <i class="fas fa-minus"></i>
                        </div>
                        {% endif %}
                      {% endfor %}
                    </td>
                    {% endfor %}
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
            {% else %}
            <div class="prof-schedule-empty-state">
              <i class="fas fa-calendar-times"></i>
              <p>Sin bloques asignados todavía.</p>
            </div>
            {% endif %}
          </section>

          {% if horarios_por_curso %}
          <section class="prof-schedule-card">
            <header class="prof-schedule-card__header">
              <div>
                <h2>Resumen por curso</h2>
                <p>Bloques, estudiantes y jefaturas asociadas a cada curso.</p>
              </div>
            </header>
            <div class="prof-course-grid">
              {% for item in horarios_por_curso %}
              <article class="prof-course-card">
                <div class="prof-course-card__header">
                  <span class="prof-course-tag">{{ item.curso.get_nivel_display }}{{ item.curso.paralelo }}</span>
                  {% if item.es_profesor_jefe %}
                  <span class="prof-course-badge">Profesor jefe</span>
                  {% endif %}
                </div>
                <div class="prof-course-card__meta">
                  <span><i class="fas fa-user-graduate"></i>{{ item.total_estudiantes }} estudiante{{ item.total_estudiantes|pluralize:",s" }}</span>
                  <span><i class="fas fa-clock"></i>{{ item.total_bloques }} bloque{{ item.total_bloques|pluralize:",s" }}</span>
                </div>
                {% if item.bloques %}
                <ul class="prof-course-sessions">
                  {% for horario in item.bloques %}
                  <li>
                    <span class="prof-course-session__day">{{ horario.get_dia_display }}</span>
                    <span class="prof-course-session__time">{{ horario.hora_inicio|time:"H:i" }} - {{ horario.hora_fin|time:"H:i" }}</span>
                    <span class="prof-course-session__subject">{{ horario.asignatura.nombre|default:"Sin asignatura" }}</span>
                  </li>
                  {% endfor %}
                </ul>
                {% else %}
                <div class="prof-course-empty">Sin bloques programados.</div>
                {% endif %}
              </article>
              {% endfor %}
            </div>
          </section>
          {% endif %}
        </div>

        <aside class="prof-schedule-side">
          <section class="prof-schedule-card">
            <header class="prof-schedule-card__header">
              <div>
                <h2>Próximas clases</h2>
                <p>Planifica tu semana con los próximos bloques.</p>
              </div>
            </header>
            {% if proximas_clases %}
            <ul class="prof-upcoming-list">
              {% for clase in proximas_clases %}
              <li class="prof-upcoming-item{% if clase.es_hoy %} is-today{% endif %}">
                <div class="prof-upcoming-item__date">
                  <span>{{ clase.dia_nombre }}</span>
                  <small>{{ clase.fecha|date:"d M" }}</small>
                </div>
                <div class="prof-upcoming-item__info">
                  <strong>{{ clase.asignatura.nombre|default:"Sin asignatura" }}</strong>
                  <span>{{ clase.curso.nombre }}</span>
                  <small>{{ clase.hora_inicio|time:"H:i" }} - {{ clase.hora_fin|time:"H:i" }}</small>
                </div>
              </li>
              {% endfor %}
            </ul>
            {% else %}
            <div class="prof-schedule-empty-state">
              <i class="fas fa-calendar-check"></i>
              <p>No hay clases en los próximos días.</p>
            </div>
            {% endif %}
          </section>

          <section class="prof-schedule-card">
            <header class="prof-schedule-card__header">
              <div>
                <h2>Carga por asignatura</h2>
                <p>Horas totales por cada asignatura responsable.</p>
              </div>
            </header>
            {% if asignaturas_resumen %}
            <ul class="prof-asignaturas-list">
              {% for data in asignaturas_resumen %}
              <li class="prof-asignaturas-item">
                <div>
                  <strong>{{ data.nombre }}</strong>
                  {% if data.codigo %}<small class="text-muted d-block">Código: {{ data.codigo }}</small>{% endif %}
                  {% if data.cursos %}<small class="text-muted d-block">{{ data.cursos|join:", " }}</small>{% endif %}
                </div>
                <span class="prof-asignaturas-pill">{{ data.cantidad }} bloque{{ data.cantidad|pluralize:",s" }}</span>
              </li>
              {% endfor %}
            </ul>
            {% else %}
            <div class="prof-schedule-empty-state">
              <i class="fas fa-info-circle"></i>
              <p>Sin asignaturas registradas.</p>
            </div>
            {% endif %}
          </section>

          <section class="prof-schedule-card">
            <header class="prof-schedule-card__header">
              <div>
                <h2>Acciones rápidas</h2>
                <p>Ahorra tiempo con accesos directos.</p>
              </div>
            </header>
            <div class="prof-quick-actions">
              <a href="{% url 'listar_cursos' %}" class="prof-quick-action">
                <i class="fas fa-users"></i>
                <div>
                  <strong>Mis cursos</strong>
                  <small>Ver matrículas y jefaturas.</small>
                </div>
              </a>
              <a href="{% url 'listar_asignaturas' %}" class="prof-quick-action">
                <i class="fas fa-book"></i>
                <div>
                  <strong>Mis asignaturas</strong>
                  <small>Gestionar contenidos.</small>
                </div>
              </a>
              <a href="{% url 'calendario' %}" class="prof-quick-action">
                <i class="fas fa-calendar-alt"></i>
                <div>
                  <strong>Calendario</strong>
                  <small>Eventos y evaluaciones.</small>
                </div>
              </a>
            </div>
          </section>
        </aside>
      </div>

      {% endif %}
    </div>

    {% endif %}
  </div>
</div>

<!-- Estilos específicos para la página de horarios -->
<style>
.fade-in {
  animation: fadeInUp 0.6s ease;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(18px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.student-alert {
  background: #fff7ed;
  border: 1px solid #fed7aa;
  border-radius: 1rem;
  padding: 2.5rem 2rem;
  text-align: center;
  color: #9a3412;
  box-shadow: 0 18px 40px -24px rgba(251, 146, 60, 0.6);
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  align-items: center;
}

.student-alert i {
  font-size: 2.5rem;
}

.student-alert--danger {
  background: #fef2f2;
  border-color: #fecaca;
  color: #b91c1c;
  box-shadow: 0 18px 40px -24px rgba(248, 113, 113, 0.6);
}

.student-alert--warning {
  background: #fffbeb;
  border-color: #fde68a;
  color: #92400e;
}

.student-schedule {
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.student-schedule-hero {
  background: linear-gradient(135deg, #0f172a, #1d4ed8);
  color: #fff;
  border-radius: 1.5rem;
  padding: 2.25rem;
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  justify-content: space-between;
  position: relative;
  overflow: hidden;
  box-shadow: 0 24px 55px -26px rgba(15, 23, 42, 0.85);
}

.student-schedule-hero::after {
  content: "";
  position: absolute;
  inset: auto -120px -120px auto;
  width: 240px;
  height: 240px;
  background: radial-gradient(circle, rgba(255,255,255,0.18) 0%, rgba(255,255,255,0) 70%);
}

.student-schedule-hero__header {
  display: flex;
  gap: 1.5rem;
  align-items: flex-start;
  flex: 1 1 320px;
  min-width: 280px;
  position: relative;
  z-index: 1;
}

.student-schedule-hero__icon {
  width: 64px;
  height: 64px;
  border-radius: 20px;
  background: rgba(255,255,255,0.16);
  display: grid;
  place-items: center;
  font-size: 1.8rem;
}

.student-schedule-hero__chip {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.85rem;
  background: rgba(255,255,255,0.15);
  padding: 0.35rem 0.85rem;
  border-radius: 999px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.student-schedule-hero__title {
  font-size: 2.2rem;
  font-weight: 700;
  margin: 0.35rem 0;
}

.student-schedule-hero__subtitle {
  margin: 0 0 1rem;
  max-width: 560px;
  color: rgba(226,232,240,0.85);
}

.student-schedule-hero__meta {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem 1.25rem;
  font-size: 0.95rem;
  color: rgba(226,232,240,0.9);
}

.student-schedule-hero__meta span {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}

.student-schedule-hero__aside {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 1rem;
  min-width: 220px;
  flex: 0 0 auto;
  position: relative;
  z-index: 1;
}

.student-schedule-hero__time {
  font-size: 0.9rem;
  color: rgba(226,232,240,0.85);
  text-transform: capitalize;
}

.student-schedule-hero__metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
  width: 100%;
}

.student-metric {
  background: rgba(15,23,42,0.35);
  border: 1px solid rgba(148,163,184,0.25);
  border-radius: 1rem;
  padding: 1rem 1.1rem;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  font-size: 0.85rem;
  letter-spacing: 0.03em;
  text-transform: uppercase;
}

.student-metric strong {
  font-size: 1.8rem;
  font-weight: 700;
  color: #fff;
}

.student-metric small {
  font-size: 0.7rem;
  color: rgba(226,232,240,0.8);
}

.student-schedule-section {
  background: #fff;
  border-radius: 1.25rem;
  padding: 2rem;
  border: 1px solid #e2e8f0;
  box-shadow: 0 24px 45px -32px rgba(15, 23, 42, 0.35);
}

.student-schedule-section__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1.75rem;
}

.student-schedule-section__header h2 {
  margin: 0;
  font-size: 1.5rem;
  font-weight: 700;
  color: #0f172a;
}

.student-schedule-section__header p {
  margin: 0;
  color: #64748b;
}

.student-week-grid {
  display: grid;
  gap: 1rem;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
}

.student-week-card {
  border: 1px solid #e2e8f0;
  border-radius: 1rem;
  padding: 1.2rem 1.4rem;
  background: #f8fafc;
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
  color: #0f172a;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.student-week-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 18px 32px -24px rgba(15, 23, 42, 0.35);
}

.student-week-card header {
  display: flex;
  justify-content: space-between;
  font-size: 0.9rem;
  font-weight: 600;
}

.student-week-card strong {
  font-size: 2rem;
  font-weight: 700;
}

.student-week-card span:last-child {
  color: #64748b;
  font-size: 0.85rem;
}

.student-week-card.is-today {
  background: linear-gradient(135deg, #1d4ed8, #2563eb);
  color: #fff;
  border-color: transparent;
  box-shadow: 0 20px 35px -24px rgba(37, 99, 235, 0.8);
}

.student-week-card.is-today:hover {
  box-shadow: 0 26px 45px -28px rgba(37, 99, 235, 0.9);
}

.student-upcoming-grid {
  display: grid;
  gap: 1rem;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.student-upcoming-card {
  border-radius: 1rem;
  border: 1px solid #e2e8f0;
  background: #f8fafc;
  padding: 1.3rem;
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.student-upcoming-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 20px 38px -30px rgba(15, 23, 42, 0.45);
}

.student-upcoming-card__head {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  font-weight: 600;
  color: #1e293b;
}

.student-upcoming-card__time {
  font-size: 0.95rem;
  color: #1d4ed8;
  font-weight: 600;
}

.student-upcoming-card__subject {
  font-weight: 600;
  color: #0f172a;
}

.student-upcoming-card__teacher {
  color: #64748b;
}

.student-upcoming-card.is-today {
  background: linear-gradient(135deg, rgba(37, 99, 235, 0.1), #dbeafe);
  border-color: rgba(37, 99, 235, 0.35);
}

.student-schedule-table-wrapper {
  border: 1px solid #e2e8f0;
  border-radius: 1.1rem;
  overflow: hidden;
}

.student-schedule-table {
  margin-bottom: 0;
  background: #fff;
}

.tabla-horarios-detallada {
  font-size: 0.9rem;
  border-collapse: separate;
  border-spacing: 0;
}

.tabla-horarios-detallada th,
.tabla-horarios-detallada td {
  border: 1px solid #e2e8f0;
  vertical-align: middle;
  position: relative;
  background: #fff;
}

.hora-columna {
  background: linear-gradient(135deg, #f8fafc, #e2e8f0);
  font-weight: 600;
  color: #0f172a;
  min-width: 100px;
}

.dia-columna {
  background: linear-gradient(135deg, #dbeafe, #c7d2fe);
  color: #1d4ed8;
  font-weight: 700;
  min-width: 150px;
}

.dia-header {
  text-align: center;
}

.dia-nombre {
  font-size: 0.95rem;
  font-weight: 700;
}

.dia-codigo {
  display: block;
  font-size: 0.7rem;
  color: #475569;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.horario-dia-actual {
  background: linear-gradient(135deg, #fde68a, #fbbf24) !important;
  color: #92400e !important;
}

.horario-dia-actual-celda {
  background: rgba(250, 204, 21, 0.16) !important;
}

.hora-bloque {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 0.55rem 0.25rem;
}

.horario-cell {
  padding: 10px 6px;
  min-width: 150px;
  height: 88px;
}

.student-schedule-cell {
  background: #f8fafc;
}

.student-schedule-slot {
  background: linear-gradient(135deg, #1d4ed8, #2563eb);
  color: #fff;
  border-radius: 0.9rem;
  padding: 0.65rem;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  font-size: 0.8rem;
  text-align: center;
  height: 100%;
  justify-content: center;
  box-shadow: 0 10px 25px -18px rgba(37, 99, 235, 0.85);
}

.student-schedule-slot strong {
  font-size: 0.85rem;
}

.student-schedule-slot small {
  font-size: 0.7rem;
  color: rgba(255,255,255,0.82);
}

.student-schedule-slot--empty {
  background: rgba(226, 232, 240, 0.65);
  color: #475569;
}

.student-schedule-slot--empty i {
  opacity: 0.5;
}

.student-schedule-table-actions {
  margin-top: 1.5rem;
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: 1rem;
  align-items: center;
}

.student-schedule-actions {
  display: flex;
  gap: 0.75rem;
}

.student-schedule-legend {
  display: flex;
  gap: 1.25rem;
  color: #475569;
  font-size: 0.9rem;
  align-items: center;
}

.legend-dot {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  display: inline-block;
  margin-right: 0.5rem;
  border: 2px solid transparent;
}

.legend-dot--class {
  background: linear-gradient(135deg, #2563eb, #1d4ed8);
}

.legend-dot--empty {
  background: rgba(226,232,240,0.7);
  border-color: #cbd5f5;
}

.student-subject-grid {
  display: grid;
  gap: 1.2rem;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.student-subject-card {
  border: 1px solid #e2e8f0;
  border-radius: 1rem;
  padding: 1.35rem;
  background: #f8fafc;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.student-subject-card__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.5rem;
}

.student-subject-card__header strong {
  font-size: 1.1rem;
  color: #0f172a;
}

.student-subject-card__code {
  font-size: 0.7rem;
  text-transform: uppercase;
  padding: 0.15rem 0.55rem;
  border-radius: 999px;
  background: #e2e8f0;
  color: #475569;
}

.student-subject-card__meta {
  margin: 0;
  font-weight: 600;
  color: #1e293b;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.student-subject-card__progress {
  height: 6px;
  border-radius: 999px;
  background: rgba(148,163,184,0.3);
  overflow: hidden;
}

.student-subject-card__progress span {
  display: block;
  height: 100%;
  background: linear-gradient(135deg, #2563eb, #1d4ed8);
  border-radius: inherit;
}

.student-quick-grid {
  display: grid;
  gap: 1.2rem;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.student-quick-card {
  border-radius: 1.05rem;
  padding: 1.4rem;
  color: #fff;
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
  text-decoration: none;
  box-shadow: 0 18px 42px -26px rgba(15, 23, 42, 0.85);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.student-quick-card i {
  font-size: 1.6rem;
}

.student-quick-card strong {
  font-size: 1.15rem;
}

.student-quick-card small {
  color: rgba(255,255,255,0.85);
}

.student-quick-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 26px 55px -32px rgba(15, 23, 42, 0.9);
}

.student-empty-state {
  text-align: center;
  padding: 2.5rem 1.5rem;
  color: #64748b;
  display: flex;
  flex-direction: column;
  gap: 0.85rem;
  align-items: center;
}

.student-empty-state i {
  font-size: 2.2rem;
  color: #94a3b8;
}

@media (max-width: 992px) {
  .student-schedule-hero {
    padding: 2rem;
  }

  .student-schedule-hero__aside {
    align-items: flex-start;
  }

  .student-week-grid,
  .student-upcoming-grid,
  .student-subject-grid,
  .student-quick-grid {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  }
}

@media (max-width: 768px) {
  .student-schedule-section {
    padding: 1.6rem;
  }

  .student-schedule-hero__metrics {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .tabla-horarios-detallada {
    font-size: 0.78rem;
  }

  .horario-cell {
    min-width: 120px;
    height: 72px;
  }

  .student-schedule-slot {
    font-size: 0.72rem;
  }
}

@media (max-width: 576px) {
  .student-schedule-hero {
    padding: 1.5rem;
  }

  .student-schedule-hero__title {
    font-size: 1.85rem;
  }

  .student-schedule-hero__metrics {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .tabla-horarios-detallada {
    font-size: 0.68rem;
  }

  .horario-cell {
    min-width: 100px;
    height: 60px;
  }

  .student-schedule-slot {
    padding: 0.45rem;
    font-size: 0.65rem;
  }
}

/* Layout específico para profesores */
.prof-schedule {
  display: flex;
  flex-direction: column;
  gap: 1.75rem;
}

.prof-schedule-card {
  background: #fff;
  border: 1px solid #e5e7eb;
  border-radius: 1.25rem;
  padding: 1.75rem;
  box-shadow: 0 18px 42px rgba(15, 23, 42, 0.1);
}

.prof-schedule-hero {
  background: linear-gradient(135deg, #2563eb, #1d4ed8);
  color: #fff;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.prof-schedule-hero__content {
  display: flex;
  align-items: center;
  gap: 1.25rem;
}

.prof-schedule-hero__icon {
  width: 56px;
  height: 56px;
  border-radius: 16px;
  background: rgba(255, 255, 255, 0.18);
  display: grid;
  place-items: center;
  font-size: 1.5rem;
}

.prof-schedule-hero__title {
  font-size: 1.65rem;
  font-weight: 700;
  margin-bottom: 0.35rem;
}

.prof-schedule-hero__subtitle {
  margin: 0;
  opacity: 0.85;
}

.prof-schedule-hero__meta {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  font-size: 0.9rem;
  opacity: 0.9;
}

.prof-schedule-hero__meta span {
  display: inline-flex;
  align-items: center;
  gap: 0.45rem;
  padding: 0.35rem 0.75rem;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.18);
}

.prof-schedule-hero__time {
  margin-top: 0.75rem;
  font-size: 0.85rem;
  opacity: 0.75;
}

.prof-schedule-hero__metrics {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.prof-schedule-metric {
  background: rgba(255, 255, 255, 0.16);
  border-radius: 1rem;
  padding: 0.85rem 1.2rem;
  min-width: 160px;
}

.prof-schedule-metric span {
  display: block;
  font-size: 0.85rem;
  opacity: 0.85;
}

.prof-schedule-metric strong {
  font-size: 1.65rem;
  font-weight: 700;
}

.prof-schedule-grid {
  display: grid;
  grid-template-columns: minmax(0, 2.1fr) minmax(0, 1fr);
  gap: 1.5rem;
  align-items: flex-start;
}

.prof-schedule-card__header {
  display: flex;
  justify-content: space-between;
  gap: 1rem;
  align-items: flex-start;
  margin-bottom: 1.25rem;
}

.prof-schedule-card__header h2 {
  font-size: 1.25rem;
  font-weight: 700;
  margin-bottom: 0.35rem;
}

.prof-schedule-card__header p {
  margin: 0;
  color: #64748b;
  font-size: 0.9rem;
}

.prof-schedule-card__actions {
  display: flex;
  gap: 0.5rem;
}

.prof-schedule-table {
  border-radius: 1rem;
  border: 1px solid #e5e7eb;
  overflow: hidden;
}

.prof-schedule-slot {
  background: linear-gradient(135deg, #16a34a, #15803d);
  color: #fff;
  border-radius: 0.85rem;
  padding: 0.75rem;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  box-shadow: 0 10px 24px rgba(22, 163, 74, 0.25);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.prof-schedule-slot__subject {
  font-weight: 600;
  font-size: 0.85rem;
}

.prof-schedule-slot__course {
  font-size: 0.75rem;
  opacity: 0.9;
}

.prof-schedule-slot:hover {
  transform: translateY(-2px);
  box-shadow: 0 16px 32px rgba(22, 163, 74, 0.3);
}

.prof-schedule-slot--empty {
  background: #f1f5f9;
  color: #94a3b8;
  box-shadow: none;
}

.prof-schedule-empty,
.prof-schedule-empty-state {
  text-align: center;
  padding: 2.5rem 1rem;
  display: grid;
  gap: 0.75rem;
  justify-items: center;
  color: #475569;
}

.prof-schedule-empty i,
.prof-schedule-empty-state i {
  font-size: 2.5rem;
  color: #2563eb;
}

.prof-course-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 1rem;
}

.prof-course-card {
  border: 1px solid #e2e8f0;
  border-radius: 1rem;
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  background: #f8fafc;
}

.prof-course-card__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.5rem;
}

.prof-course-tag {
  font-weight: 600;
  color: #1d4ed8;
  background: rgba(37, 99, 235, 0.12);
  border-radius: 999px;
  padding: 0.25rem 0.75rem;
}

.prof-course-badge {
  font-size: 0.75rem;
  color: #0f766e;
  background: rgba(45, 212, 191, 0.18);
  border-radius: 999px;
  padding: 0.25rem 0.6rem;
  font-weight: 600;
}

.prof-course-card__meta {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
  font-size: 0.85rem;
  color: #475569;
}

.prof-course-card__meta i {
  margin-right: 0.4rem;
}

.prof-course-sessions {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 0.5rem;
}

.prof-course-sessions li {
  display: grid;
  gap: 0.25rem;
  background: #fff;
  border-radius: 0.75rem;
  padding: 0.75rem;
  border: 1px solid #e2e8f0;
}

.prof-course-session__day {
  font-weight: 600;
  color: #0f172a;
}

.prof-course-session__time {
  font-size: 0.8rem;
  color: #475569;
}

.prof-course-session__subject {
  font-size: 0.8rem;
  color: #2563eb;
}

.prof-course-empty {
  font-size: 0.85rem;
  color: #94a3b8;
}

.prof-schedule-side {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.prof-upcoming-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  gap: 0.75rem;
}

.prof-upcoming-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.9rem;
  border-radius: 1rem;
  border: 1px solid #e2e8f0;
  background: #f8fafc;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.prof-upcoming-item.is-today {
  border-color: #1d4ed8;
  background: rgba(37, 99, 235, 0.08);
}

.prof-upcoming-item:hover {
  transform: translateY(-3px);
  box-shadow: 0 16px 32px rgba(15, 23, 42, 0.12);
}

.prof-upcoming-item__date {
  min-width: 98px;
  text-align: center;
  font-weight: 600;
  color: #1e293b;
}

.prof-upcoming-item__date small {
  display: block;
  font-size: 0.75rem;
  color: #64748b;
}

.prof-upcoming-item__info {
  display: grid;
  gap: 0.15rem;
  font-size: 0.85rem;
  color: #475569;
}

.prof-upcoming-item__info strong {
  font-size: 0.95rem;
  color: #0f172a;
}

.prof-asignaturas-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  gap: 0.75rem;
}

.prof-asignaturas-item {
  display: flex;
  justify-content: space-between;
  gap: 1rem;
  align-items: flex-start;
  border: 1px dashed #cbd5f5;
  border-radius: 0.9rem;
  padding: 0.75rem 1rem;
  background: #f8fafc;
}

.prof-asignaturas-item strong {
  display: block;
  color: #0f172a;
}

.prof-asignaturas-pill {
  background: rgba(37, 99, 235, 0.12);
  color: #1d4ed8;
  border-radius: 999px;
  padding: 0.25rem 0.75rem;
  font-size: 0.8rem;
  font-weight: 600;
  white-space: nowrap;
}

.prof-quick-actions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 0.75rem;
}

.prof-quick-action {
  display: flex;
  gap: 0.75rem;
  align-items: center;
  padding: 0.9rem 1rem;
  border-radius: 0.9rem;
  border: 1px solid #e2e8f0;
  background: #f8fafc;
  color: #0f172a;
  text-decoration: none;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.prof-quick-action i {
  font-size: 1.2rem;
  color: #1d4ed8;
}

.prof-quick-action:hover {
  transform: translateY(-4px);
  box-shadow: 0 16px 32px rgba(15, 23, 42, 0.12);
}

.prof-schedule-main {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

@media (max-width: 1199px) {
  .prof-schedule-grid {
    grid-template-columns: 1fr;
  }
  .prof-schedule-side {
    flex-direction: row;
    flex-wrap: wrap;
  }
  .prof-schedule-side .prof-schedule-card {
    flex: 1 1 320px;
  }
}

@media (max-width: 991px) {
  .prof-schedule-hero {
    padding: 1.5rem;
  }
  .prof-schedule-hero__metrics {
    flex-direction: column;
    align-items: stretch;
  }
  .prof-quick-actions {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  .prof-schedule-hero__content {
    flex-direction: column;
    align-items: flex-start;
  }
  .prof-upcoming-item {
    flex-direction: column;
    align-items: flex-start;
  }
  .prof-upcoming-item__date {
    min-width: auto;
  }
}

@media (max-width: 576px) {
  .prof-schedule-card {
    padding: 1.25rem;
  }
  .prof-schedule-metric {
    width: 100%;
  }
  .prof-course-grid {
    grid-template-columns: 1fr;
  }
  .prof-course-sessions li {
    grid-template-columns: 1fr;
  }
}

/* Animaciones de entrada */
@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.card {
  animation: slideInUp 0.6s ease forwards;
}

.card:nth-child(1) { animation-delay: 0.1s; }
.card:nth-child(2) { animation-delay: 0.2s; }
.card:nth-child(3) { animation-delay: 0.3s; }

/* Responsive */
@media (max-width: 768px) {
  .tabla-horarios-detallada {
    font-size: 0.75rem;
  }
  
  .horario-cell {
    min-width: 100px;
    height: 60px;
  }
  
  .clase-bloque-detallada {
    padding: 4px;
    font-size: 0.65rem;
  }
  
  .asignatura-nombre {
    font-size: 0.7rem;
  }
  
  .profesor-nombre {
    font-size: 0.6rem;
  }
}

@media (max-width: 576px) {
  .tabla-horarios-detallada {
    font-size: 0.65rem;
  }
  
  .horario-cell {
    min-width: 80px;
    height: 50px;
  }
  
  .clase-bloque-detallada {
    padding: 2px;
    font-size: 0.6rem;
  }
  
  .asignatura-nombre {
    font-size: 0.65rem;
    margin-bottom: 0.1rem;
  }
  
  .profesor-nombre {
    display: none; /* Ocultar en pantallas muy pequeñas */
  }
}
</style>

<!-- JavaScript específico para horarios -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Actualizar fecha y hora actual
    function updateDateTime() {
        const now = new Date();
        const options = { 
            weekday: 'long', 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        };
        const studentClock = document.getElementById('studentScheduleClock');
        const profesorClock = document.getElementById('currentDateTimeProfesor');
        const formatted = now.toLocaleDateString('es-ES', options);
        if (studentClock) {
          studentClock.textContent = formatted.charAt(0).toUpperCase() + formatted.slice(1);
        }
        if (profesorClock) {
          profesorClock.textContent = formatted.charAt(0).toUpperCase() + formatted.slice(1);
        }
    }
    
    updateDateTime();
    setInterval(updateDateTime, 60000); // Actualizar cada minuto
    
    // Animaciones de entrada escalonadas
      const cards = document.querySelectorAll('.student-schedule-hero, .student-schedule-section, .prof-schedule-card');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.6s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 150);
    });
    
    // Tooltip para clases
    const claseBloques = document.querySelectorAll('.student-schedule-slot, .prof-schedule-slot');
    claseBloques.forEach(bloque => {
        bloque.addEventListener('mouseenter', function() {
            // Añadir efecto de resaltado
            this.style.zIndex = '10';
        });
        
        bloque.addEventListener('mouseleave', function() {
            this.style.zIndex = 'auto';
        });
    });
    
    // Resaltar día actual
    const hoy = new Date();
    const dayCodes = ['DO', 'LU', 'MA', 'MI', 'JU', 'VI', 'SA'];
    const diaActualCodigo = dayCodes[hoy.getDay()];

    if (diaActualCodigo) {
      const tablas = document.querySelectorAll('.tabla-horarios-detallada');
      tablas.forEach(tabla => {
        const headers = tabla.querySelectorAll('thead th[data-dia]');
        headers.forEach(header => {
          if (header.dataset.dia === diaActualCodigo) {
            header.classList.add('horario-dia-actual');
            const index = Array.from(header.parentElement.children).indexOf(header);
            const filas = tabla.querySelectorAll('tbody tr');
            filas.forEach(fila => {
              const celda = fila.children[index];
              if (celda) {
                celda.classList.add('horario-dia-actual-celda');
              }
            });
          }
        });
      });
    }
});

// Función para imprimir horario
function imprimirHorario() {
    // Crear ventana de impresión
    const ventanaImpresion = window.open('', '_blank');
    
    // Contenido HTML para imprimir
    const contenido = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Horario de Clases</title>
            <style>
                body { font-family: Arial, sans-serif; margin: 20px; }
                h1 { text-align: center; color: #007bff; }
                table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                th, td { border: 1px solid #000; padding: 8px; text-align: center; }
                th { background-color: #f8f9fa; font-weight: bold; }
                .clase-info { font-size: 0.8rem; line-height: 1.2; }
                .asignatura { font-weight: bold; }
                .profesor { font-size: 0.7rem; color: #666; }
                .salon { font-size: 0.7rem; color: #888; }
            </style>
        </head>
        <body>
            <h1>Mi Horario de Clases</h1>
            <p><strong>Curso:</strong> {{ curso_actual }}</p>
            <p><strong>Estudiante:</strong> {{ user.first_name }} {{ user.last_name }}</p>
            <p><strong>Fecha de impresión:</strong> ${new Date().toLocaleDateString('es-ES')}</p>
            ${document.querySelector('.tabla-horarios-detallada').outerHTML}
        </body>
        </html>
    `;
    
    ventanaImpresion.document.write(contenido);
    ventanaImpresion.document.close();
    
    // Imprimir después de cargar
    ventanaImpresion.onload = function() {
        ventanaImpresion.print();
        ventanaImpresion.close();
    };
}
</script>

{% endblock %}