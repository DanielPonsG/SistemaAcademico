{% extends "index_master.html" %}

{% block extra_css %}
<style>
.director-dashboard {
  display: flex;
  flex-direction: column;
  gap: 1.25rem;
  min-height: calc(100vh - 220px);
}

.director-dashboard__kpis {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.director-kpi-card {
  position: relative;
  overflow: hidden;
  border: 0;
  border-radius: 1rem;
  color: #fff;
  background: linear-gradient(135deg, #0d6efd, #0943ad);
  box-shadow: 0 18px 36px rgba(13, 110, 253, 0.2);
}

.director-kpi-card::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(145deg, rgba(255, 255, 255, 0.12), transparent);
}

.director-kpi-card .card-body {
  position: relative;
  z-index: 1;
  padding: 1.15rem 1.3rem;
}

.director-kpi-icon {
  position: absolute;
  top: 1rem;
  right: 1rem;
  font-size: 2.75rem;
  opacity: 0.28;
}

.director-kpi-card.director-kpi-success {
  background: linear-gradient(135deg, #198754, #0f5132);
}

.director-kpi-card.director-kpi-warning {
  background: linear-gradient(135deg, #ffc107, #c08700);
}

.director-kpi-card.director-kpi-info {
  background: linear-gradient(135deg, #0dcaf0, #0a6cb1);
}

.director-kpi-label {
  font-size: 0.9rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.director-kpi-value {
  font-size: 2rem;
  font-weight: 700;
  line-height: 1.1;
}

.director-dashboard__content {
  display: block;
}

.director-main-column,
.director-side-column {
  display: block;
  gap: 1rem;
}

.director-main-column > .card,
.director-side-column > .card {
  margin-bottom: 1.5rem;
}

@media (min-width: 1200px) {
  .director-dashboard__content {
    display: flex;
    gap: 1.5rem;
    align-items: flex-start;
  }
  .director-main-column {
    flex: 0 0 65%;
    max-width: 65%;
  }
  .director-side-column {
    flex: 0 0 35%;
    max-width: 35%;
  }
}

.director-card {
  border: 0;
  border-radius: 1rem;
  box-shadow: 0 10px 24px rgba(15, 23, 42, 0.08);
  display: flex;
  flex-direction: column;
}

.director-card .card-body {
  padding: 1.2rem 1.35rem;
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
}

.director-card,
.director-card .card-body,
.director-scroll-area,
.director-timeline,
.director-mini-card {
  height: auto !important;
  max-height: none !important;
  overflow: visible !important;
}

.director-section-title {
  font-weight: 700;
  color: #1f2937;
}

.director-pill-count {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  background: #eff4ff;
  color: #0d6efd;
  font-size: 0.85rem;
  font-weight: 600;
  border-radius: 999px;
  padding: 0.25rem 0.75rem;
}

.director-progress {
  height: 0.75rem;
  border-radius: 999px;
  background: #e9ecef;
  overflow: hidden;
}

.director-progress-bar {
  width: calc(var(--progress-value, 0) * 1%);
  transition: width 0.45s ease;
}

.director-mini-card {
  border: 1px solid #e5e7eb;
  border-radius: 0.85rem;
  padding: 0.75rem 1rem;
  background: #fff;
  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.04);
}

.director-mini-card h6 {
  font-weight: 600;
  font-size: 0.95rem;
}

.director-activity-item {
  padding: 0.35rem 0;
  border-bottom: 1px dashed rgba(148, 163, 184, 0.35);
}

.director-activity-item:last-child {
  border-bottom: none;
}

.director-scroll-area {
  max-height: none;
  overflow: visible;
  padding-right: 0;
}

.director-scroll-area::-webkit-scrollbar {
  width: 6px;
}

.director-scroll-area::-webkit-scrollbar-thumb {
  background: rgba(15, 23, 42, 0.18);
  border-radius: 999px;
}

.director-timeline {
  position: relative;
  margin: 0;
  padding-left: 1.5rem;
}

.director-timeline::before {
  content: "";
  position: absolute;
  top: 0.25rem;
  bottom: 0.25rem;
  left: 0.35rem;
  width: 2px;
  background: #e2e8f0;
}

.director-timeline-item {
  position: relative;
  padding-left: 1.5rem;
  margin-bottom: 1.1rem;
}

.director-timeline-item:last-child {
  margin-bottom: 0;
}

.director-timeline-bullet {
  position: absolute;
  top: 0.3rem;
  left: 0;
  width: 12px;
  height: 12px;
  border-radius: 999px;
  background: #0d6efd;
  box-shadow: 0 0 0 4px rgba(13, 110, 253, 0.15);
}

.director-empty-state {
  min-height: 110px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px dashed #cbd5f5;
  border-radius: 1rem;
  background: #f8fafc;
  color: #64748b;
  padding: 1rem;
}

.director-quick-actions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
}

.director-quick-actions .director-mini-card {
  min-height: 130px;
  text-align: center;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.director-quick-actions .director-mini-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 24px rgba(15, 23, 42, 0.1);
}

.director-card--quick .director-mini-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.director-dashboard {
  padding-bottom: 1.5rem;
}

.director-card .director-scroll-area {
  max-height: none;
  overflow: visible;
  flex: 1 1 auto;
}

@media (max-width: 991px) {
  .director-card .director-scroll-area {
    max-height: 260px;
    overflow-y: auto;
  }
}

@media (max-width: 1199px) {
  .director-dashboard {
    min-height: auto;
  }
  .director-scroll-area {
    max-height: 240px;
    overflow-y: auto;
    padding-right: 0.3rem;
  }
  .director-main-column > .card,
  .director-side-column > .card {
    margin-bottom: 1.25rem;
  }
}

@media (max-width: 767px) {
  .director-dashboard__kpis {
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  }
  .director-dashboard__content {
    gap: 0.75rem;
  }
}

.fade-in {
  animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.student-dashboard {
  display: flex;
  flex-direction: column;
  gap: 1.75rem;
}

.student-hero {
  background: linear-gradient(135deg, #4f46e5, #6366f1);
  color: #fff;
  border-radius: 1.5rem;
  padding: 2rem;
  box-shadow: 0 20px 48px rgba(79, 70, 229, 0.25);
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.student-hero__content {
  display: flex;
  align-items: center;
  gap: 1.5rem;
  flex-wrap: wrap;
}

.student-hero__icon {
  width: 60px;
  height: 60px;
  border-radius: 18px;
  background: rgba(255, 255, 255, 0.2);
  display: grid;
  place-items: center;
  font-size: 1.8rem;
}

.student-hero__chip {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  background: rgba(255, 255, 255, 0.24);
  padding: 0.3rem 0.8rem;
  border-radius: 999px;
  font-size: 0.85rem;
  font-weight: 600;
  letter-spacing: 0.02em;
}

.student-hero__title {
  font-size: 1.85rem;
  font-weight: 700;
  margin: 0.35rem 0;
}

.student-hero__subtitle {
  margin: 0;
  opacity: 0.9;
}

.student-hero__meta {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
  margin-top: 0.75rem;
}

.student-hero__meta span {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.35rem 0.75rem;
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.18);
  font-size: 0.85rem;
}

.student-hero__metrics {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.student-hero-metric {
  background: rgba(255, 255, 255, 0.16);
  border-radius: 1rem;
  padding: 0.9rem 1.2rem;
  min-width: 160px;
}

.student-hero-metric span {
  display: block;
  font-size: 0.85rem;
  opacity: 0.85;
}

.student-hero-metric strong {
  display: block;
  font-size: 1.5rem;
  font-weight: 700;
}

.student-section {
  background: #fff;
  border-radius: 1.25rem;
  padding: 1.75rem;
  border: 1px solid #e5e7eb;
  box-shadow: 0 16px 36px rgba(15, 23, 42, 0.1);
  display: flex;
  flex-direction: column;
  gap: 1.25rem;
}

.student-section__header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 1rem;
}

.student-section__header h3 {
  font-size: 1.25rem;
  font-weight: 700;
  margin-bottom: 0.25rem;
}

.student-section__header p {
  margin: 0;
  color: #64748b;
  font-size: 0.9rem;
}

.student-kpi-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
  gap: 1rem;
}

.student-kpi-card {
  border: 1px solid #e2e8f0;
  border-radius: 1rem;
  padding: 1.15rem;
  display: flex;
  align-items: center;
  gap: 0.85rem;
  background: #f9fafb;
  box-shadow: 0 12px 24px rgba(15, 23, 42, 0.08);
}

.student-kpi-card i {
  width: 44px;
  height: 44px;
  border-radius: 14px;
  display: grid;
  place-items: center;
  font-size: 1.35rem;
  color: #1e293b;
}

.student-kpi-card strong {
  display: block;
  font-size: 1.4rem;
  font-weight: 700;
  color: #0f172a;
}

.student-kpi-card span {
  display: block;
  font-size: 0.85rem;
  color: #64748b;
}

.student-kpi-card--gold i {
  background: rgba(251, 191, 36, 0.2);
  color: #b45309;
}

.student-kpi-card--green i {
  background: rgba(34, 197, 94, 0.18);
  color: #15803d;
}

.student-kpi-card--blue i {
  background: rgba(59, 130, 246, 0.18);
  color: #1d4ed8;
}

.student-kpi-card--violet i {
  background: rgba(129, 140, 248, 0.2);
  color: #4c1d95;
}

.student-next-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
  gap: 1rem;
}

.student-next-card {
  border: 1px solid #e2e8f0;
  border-radius: 1rem;
  padding: 1rem;
  background: #f8fafc;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  box-shadow: 0 12px 24px rgba(15, 23, 42, 0.06);
}

.student-next-card__head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.5rem;
}

.student-next-card__head strong {
  color: #1d4ed8;
}

.student-next-card__time {
  font-size: 0.85rem;
  color: #475569;
  display: flex;
  justify-content: space-between;
  gap: 0.5rem;
}

.student-next-card__time span {
  display: block;
}

.student-next-card__item {
  display: grid;
  gap: 0.25rem;
  font-size: 0.85rem;
  color: #334155;
  border-bottom: 1px dashed #e2e8f0;
  padding-bottom: 0.6rem;
  margin-bottom: 0.6rem;
}

.student-next-card__item:last-child {
  border-bottom: none;
  padding-bottom: 0;
  margin-bottom: 0;
}

.student-weekly-table-wrapper {
  border: 1px solid #e2e8f0;
  border-radius: 1rem;
  overflow-x: auto;
}

.student-weekly-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: 0.85rem;
}

.student-weekly-cell {
  min-width: 140px;
  height: 90px;
  background: #fff;
}

.student-weekly-table th,
.student-weekly-table td {
  border: 1px solid #e2e8f0;
  padding: 0.85rem;
  text-align: center;
}

.student-weekly-hour {
  background: #f8fafc;
  font-weight: 600;
  color: #0f172a;
  min-width: 110px;
}

.student-weekly-day {
  background: linear-gradient(135deg, #e0f2fe, #bfdbfe);
  color: #1d4ed8;
  font-weight: 600;
  min-width: 140px;
}

.student-weekly-slot {
  display: grid;
  gap: 0.25rem;
  background: #1d4ed8;
  color: #fff;
  border-radius: 0.85rem;
  padding: 0.65rem;
  box-shadow: 0 10px 24px rgba(29, 78, 216, 0.28);
}

.student-weekly-slot small {
  font-size: 0.7rem;
  opacity: 0.85;
}

.student-weekly-empty {
  color: #94a3b8;
  font-size: 0.85rem;
}

.student-weekly-empty i {
  font-size: 1rem;
}

.student-quick-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1rem;
}

.student-quick-card {
  border-radius: 1.2rem;
  padding: 1.5rem;
  color: #fff;
  min-height: 160px;
  box-shadow: 0 16px 36px rgba(15, 23, 42, 0.15);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.student-quick-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 22px 48px rgba(15, 23, 42, 0.25);
}

.student-quick-card i {
  font-size: 2.25rem;
  margin-bottom: 0.75rem;
}

.student-quick-card strong {
  font-size: 1.05rem;
  margin-bottom: 0.4rem;
}

.student-quick-card small {
  font-size: 0.85rem;
  opacity: 0.85;
}

.student-empty-state {
  text-align: center;
  color: #64748b;
  padding: 2rem 1rem;
}

.student-empty-state i {
  font-size: 2.5rem;
  color: #94a3b8;
}

@media (max-width: 1199px) {
  .student-hero {
    padding: 1.75rem;
  }
  .student-weekly-day {
    min-width: 120px;
  }
}

@media (max-width: 991px) {
  .student-hero__metrics {
    flex-direction: column;
    align-items: stretch;
  }
  .student-hero-metric {
    width: 100%;
  }
}

@media (max-width: 768px) {
  .student-section {
    padding: 1.25rem;
  }
  .student-weekly-table th,
  .student-weekly-table td {
    padding: 0.6rem;
  }
  .student-weekly-day {
    min-width: 100px;
  }
}

@media (max-width: 576px) {
  .student-hero__icon {
    width: 52px;
    height: 52px;
    font-size: 1.5rem;
  }
  .student-kpi-grid {
    grid-template-columns: 1fr;
  }
  .student-quick-grid {
    grid-template-columns: 1fr;
  }
}

/* Estilos generales existentes */
.card {
  border: 1px solid #dee2e6;
}

.badge {
  font-size: 0.875rem;
}

.form-label {
  margin-bottom: 0.5rem;
}

.text-dark {
  color: #212529 !important;
}

.quick-access-card {
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid rgba(0, 0, 0, 0.125);
  border-radius: 15px;
  box-shadow: 0 6px 25px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  position: relative;
  margin-bottom: 1.5rem;
}

.quick-access-card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, rgba(255, 255, 255, 0.15), transparent);
  pointer-events: none;
  transition: opacity 0.3s ease;
  opacity: 0;
}

.quick-access-card:hover::before {
  opacity: 1;
}

.quick-access-card:hover {
  transform: translateY(-10px) scale(1.05);
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
  border-color: rgba(255, 255, 255, 0.4);
}

.quick-access-card i {
  transition: all 0.4s ease;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.quick-access-card:hover i {
  transform: scale(1.2) rotate(5deg);
  text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

.quick-access-card h6 {
  font-weight: 700;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
}

.quick-access-card small {
  opacity: 0.9;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.professor-dashboard {
  display: flex;
  flex-direction: column;
  gap: 1.75rem;
}

.professor-hero {
  position: relative;
  overflow: hidden;
  border-radius: 26px;
  background: linear-gradient(135deg, #4338ca, #2563eb);
  color: #fff;
  padding: 42px 46px;
  display: flex;
  flex-direction: column;
  gap: 18px;
  box-shadow: 0 24px 54px rgba(30, 64, 175, 0.28);
}

.professor-hero::after {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 15% 25%, rgba(255, 255, 255, 0.32), transparent 55%),
              radial-gradient(circle at 85% 20%, rgba(96, 165, 250, 0.45), transparent 58%),
              radial-gradient(circle at 50% 100%, rgba(59, 130, 246, 0.4), transparent 60%);
  mix-blend-mode: screen;
  pointer-events: none;
}

.professor-hero > * {
  position: relative;
  z-index: 1;
}

.professor-chip {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: rgba(255, 255, 255, 0.18);
  padding: 8px 18px;
  border-radius: 999px;
  font-size: 0.82rem;
  font-weight: 600;
  letter-spacing: 0.06em;
  text-transform: uppercase;
}

.professor-hero h2 {
  font-size: 2.1rem;
  font-weight: 700;
  margin: 0;
  line-height: 1.2;
}

.professor-hero p {
  margin: 0;
  max-width: 540px;
  color: rgba(255, 255, 255, 0.92);
  font-size: 1.02rem;
}

.professor-hero__meta {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.professor-meta-pill {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  border-radius: 16px;
  padding: 10px 16px;
  background: rgba(15, 23, 42, 0.2);
  backdrop-filter: blur(6px);
  font-weight: 600;
}

.professor-meta-pill strong {
  display: block;
  font-size: 1.1rem;
  line-height: 1;
}

.professor-meta-pill span {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  opacity: 0.85;
}

.professor-metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
  gap: 18px;
}

.professor-metric-card {
  position: relative;
  border-radius: 22px;
  border: 1px solid rgba(148, 163, 184, 0.22);
  padding: 24px;
  background: #fff;
  box-shadow: 0 18px 36px rgba(148, 163, 184, 0.18);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.professor-metric-card::before {
  content: "";
  position: absolute;
  inset: 0;
  opacity: 0.12;
  pointer-events: none;
}

.professor-metric-card .metric-icon {
  width: 48px;
  height: 48px;
  border-radius: 16px;
  display: grid;
  place-items: center;
  font-size: 1.4rem;
  color: #fff;
}

.professor-metric-card .metric-label {
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #64748b;
  font-weight: 600;
}

.professor-metric-card .metric-value {
  font-size: 2.1rem;
  font-weight: 700;
  color: #0f172a;
  margin: 0;
}

.professor-metric-card .metric-note {
  margin: 0;
  color: #475569;
  font-size: 0.92rem;
}

.professor-metric-card.metric-students::before {
  background: linear-gradient(135deg, #22c55e, #16a34a);
}

.professor-metric-card.metric-students .metric-icon {
  background: linear-gradient(135deg, #16a34a, #22c55e);
}

.professor-metric-card.metric-subjects::before {
  background: linear-gradient(135deg, #6366f1, #4338ca);
}

.professor-metric-card.metric-subjects .metric-icon {
  background: linear-gradient(135deg, #4338ca, #6366f1);
}

.professor-metric-card.metric-courses::before {
  background: linear-gradient(135deg, #f97316, #f59e0b);
}

.professor-metric-card.metric-courses .metric-icon {
  background: linear-gradient(135deg, #f97316, #fb923c);
}

.professor-metric-card.metric-notes::before {
  background: linear-gradient(135deg, #0ea5e9, #2563eb);
}

.professor-metric-card.metric-notes .metric-icon {
  background: linear-gradient(135deg, #1d4ed8, #2563eb);
}

.professor-actions {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.professor-actions__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.75rem;
}

.professor-actions__header h3 {
  margin: 0;
  font-weight: 700;
  color: #1f2937;
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 1.2rem;
}

.professor-actions__header p {
  margin: 0;
  color: #64748b;
  font-size: 0.92rem;
}

.professor-actions-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
  gap: 16px;
}

.professor-action-card {
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: flex-start;
  background: #fff;
  border-radius: 18px;
  border: 1px solid rgba(148, 163, 184, 0.18);
  padding: 18px 20px;
  text-decoration: none;
  color: #0f172a;
  box-shadow: 0 12px 28px rgba(15, 23, 42, 0.08);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.professor-action-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 18px 36px rgba(15, 23, 42, 0.14);
}

.professor-action-card i {
  font-size: 1.5rem;
  color: var(--professor-action-color, #2563eb);
}

.professor-action-card h6 {
  margin: 0;
  font-size: 1rem;
  font-weight: 600;
}

.professor-action-card small {
  color: #64748b;
  font-size: 0.8rem;
}

.professor-layout {
  display: grid;
  grid-template-columns: minmax(0, 2.2fr) minmax(0, 1fr);
  gap: 20px;
}

.professor-main,
.professor-side {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.professor-card {
  background: #fff;
  border-radius: 22px;
  border: 1px solid rgba(148, 163, 184, 0.16);
  padding: 24px 26px;
  box-shadow: 0 18px 40px rgba(15, 23, 42, 0.1);
  display: flex;
  flex-direction: column;
  gap: 18px;
}

.professor-card__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

.professor-card__title {
  margin: 0;
  font-size: 1.15rem;
  font-weight: 700;
  color: #1f2937;
  display: flex;
  align-items: center;
  gap: 10px;
}

.professor-card__badge {
  background: #eef2ff;
  color: #4338ca;
  font-weight: 600;
  font-size: 0.85rem;
  border-radius: 999px;
  padding: 6px 14px;
}

.professor-tile-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 14px;
}

.professor-tile {
  background: #f8fafc;
  border: 1px solid rgba(148, 163, 184, 0.25);
  border-radius: 16px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  transition: transform 0.2s ease, border-color 0.2s ease;
}

.professor-tile:hover {
  transform: translateY(-2px);
  border-color: rgba(79, 70, 229, 0.45);
}

.professor-tile__title {
  margin: 0;
  font-weight: 600;
  color: #111827;
}

.professor-tile__meta {
  margin: 0;
  color: #64748b;
  font-size: 0.85rem;
}

.professor-subject-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 12px;
}

.professor-subject-card {
  padding: 14px;
  border-radius: 14px;
  background: #f1f5f9;
  border: 1px solid rgba(148, 163, 184, 0.22);
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.professor-subject-card h6 {
  margin: 0;
  font-weight: 600;
  color: #0f172a;
  font-size: 0.95rem;
}

.professor-subject-card span {
  font-size: 0.75rem;
  color: #64748b;
  letter-spacing: 0.04em;
}

.professor-schedule-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 14px;
}

.professor-schedule-card {
  border-radius: 18px;
  border: 1px solid rgba(148, 163, 184, 0.22);
  background: #f8fafc;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.professor-schedule-card__head {
  background: rgba(79, 70, 229, 0.08);
  padding: 14px 16px;
}

.professor-schedule-card__head h6 {
  margin: 0;
  color: #4338ca;
  font-weight: 700;
  font-size: 0.95rem;
}

.professor-schedule-card__head small {
  color: #475569;
  font-size: 0.75rem;
}

.professor-schedule-list {
  padding: 14px 16px 12px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.professor-schedule-item {
  display: flex;
  justify-content: space-between;
  gap: 12px;
}

.professor-schedule-item__title {
  font-weight: 600;
  font-size: 0.9rem;
  color: #0f172a;
}

.professor-schedule-item__meta {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  font-size: 0.75rem;
  color: #64748b;
}

.professor-annotation-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 12px;
}

.professor-annotation-pill {
  border-radius: 16px;
  padding: 14px 16px;
  color: #fff;
  display: flex;
  flex-direction: column;
  gap: 4px;
  font-weight: 600;
}

.professor-annotation-pill.positive { background: linear-gradient(135deg, #22c55e, #16a34a); }
.professor-annotation-pill.neutral { background: linear-gradient(135deg, #f59e0b, #d97706); }
.professor-annotation-pill.negative { background: linear-gradient(135deg, #ef4444, #b91c1c); }
.professor-annotation-pill.total { background: linear-gradient(135deg, #334155, #0f172a); }

.professor-annotation-pill span {
  font-size: 0.75rem;
  opacity: 0.85;
}

.professor-course-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 16px;
}

.professor-course-card {
  border-radius: 18px;
  border: 1px solid rgba(148, 163, 184, 0.22);
  background: #fff;
  box-shadow: 0 16px 34px rgba(15, 23, 42, 0.08);
  padding: 18px 20px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.professor-course-card__head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

.professor-course-pill {
  background: #eef2ff;
  color: #4338ca;
  border-radius: 999px;
  padding: 6px 14px;
  font-weight: 600;
  font-size: 0.9rem;
}

.professor-course-badge {
  background: #dcfce7;
  color: #16a34a;
  border-radius: 999px;
  padding: 5px 12px;
  font-weight: 600;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.professor-course-meta {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  color: #64748b;
  font-size: 0.8rem;
}

.professor-course-meta span {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.professor-course-card__body {
  display: flex;
  gap: 14px;
  flex-wrap: wrap;
}

.professor-course-stat {
  flex: 1 1 120px;
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 12px;
  border-radius: 14px;
  background: #f8fafc;
  border: 1px solid rgba(148, 163, 184, 0.16);
}

.professor-course-stat i {
  font-size: 1.1rem;
  color: #2563eb;
}

.professor-course-stat strong {
  display: block;
  font-size: 1.1rem;
  color: #0f172a;
}

.professor-course-stat span {
  display: block;
  font-size: 0.75rem;
  color: #64748b;
  letter-spacing: 0.04em;
  text-transform: uppercase;
}

.professor-course-actions {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.professor-course-actions a {
  flex: 1 1 auto;
  text-decoration: none;
  border-radius: 12px;
  padding: 10px 12px;
  font-weight: 600;
  font-size: 0.85rem;
  text-align: center;
  border: 1px solid rgba(99, 102, 241, 0.4);
  color: #4338ca;
  transition: background 0.2s ease, color 0.2s ease;
}

.professor-course-actions a:hover {
  background: #4338ca;
  color: #fff;
}

.professor-activity-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.professor-activity-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 12px 14px;
  border-radius: 16px;
  background: #f8fafc;
  border: 1px solid rgba(148, 163, 184, 0.18);
}

.professor-activity-icon {
  width: 36px;
  height: 36px;
  border-radius: 12px;
  display: grid;
  place-items: center;
  font-size: 0.95rem;
  color: #fff;
}

.professor-activity-icon.positive { background: linear-gradient(135deg, #22c55e, #16a34a); }
.professor-activity-icon.negative { background: linear-gradient(135deg, #ef4444, #b91c1c); }
.professor-activity-icon.neutral { background: linear-gradient(135deg, #f59e0b, #d97706); }

.professor-activity-item h6 {
  margin: 0;
  font-size: 0.95rem;
  font-weight: 600;
  color: #0f172a;
}

.professor-activity-item p {
  margin: 4px 0;
  color: #64748b;
  font-size: 0.82rem;
}

.profesor-info-item {
  padding: 12px 0;
  border-bottom: 1px dashed rgba(148, 163, 184, 0.35);
}

.profesor-info-item:last-child {
  border-bottom: none;
}

.profesor-info-item small {
  font-size: 0.72rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: #94a3b8;
}

.profesor-info-item p {
  margin: 2px 0 0;
  font-weight: 600;
  color: #0f172a;
}

.professor-empty {
  text-align: center;
  padding: 24px;
  border-radius: 18px;
  background: #f8fafc;
  border: 1px dashed rgba(148, 163, 184, 0.25);
  color: #64748b;
}

.stats-card {
  transition: all 0.4s ease;
  border-radius: 15px;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(0, 0, 0, 0.08);
  position: relative;
  overflow: hidden;
}

.stats-card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
  pointer-events: none;
}

.stats-card:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
  border-color: rgba(0, 123, 255, 0.3);
}

.stats-card i {
  transition: transform 0.3s ease;
}

.stats-card:hover i {
  transform: scale(1.1);
}

.academic-section {
  margin-bottom: 3rem;
  padding: 1.5rem 0;
}

.section-title {
  border-bottom: 3px solid #e9ecef;
  padding-bottom: 0.75rem;
  margin-bottom: 2rem;
  position: relative;
}

.section-title::after {
  content: "";
  position: absolute;
  bottom: -3px;
  left: 0;
  width: 60px;
  height: 3px;
  background: linear-gradient(90deg, #007bff, #0056b3);
  border-radius: 2px;
}

.horario-cell {
  min-width: 120px;
  padding: 8px 4px;
}

.clase-bloque {
  background: linear-gradient(135deg, #007bff, #0056b3);
  color: #fff;
  border-radius: 6px;
  padding: 4px 6px;
  margin: 1px 0;
  font-size: 0.7rem;
  line-height: 1.2;
  border: 1px solid rgba(255, 255, 255, 0.2);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.clase-bloque strong {
  display: block;
  font-weight: 600;
}

.clase-bloque small {
  opacity: 0.9;
  font-size: 0.65rem;
}

.tabla-horarios {
  font-size: 0.9rem;
}

.tabla-horarios th {
  background-color: #f8f9fa !important;
  font-weight: 600;
  border: 1px solid #dee2e6;
  vertical-align: middle;
}

.tabla-horarios td {
  border: 1px solid #dee2e6;
  vertical-align: middle;
}

.hora-columna {
  background-color: #f1f3f4;
  font-weight: 600;
  color: #495057;
}

@media (max-width: 768px) {
  .quick-access-card {
    margin-bottom: 1rem;
  }
  .admin-stats-card .card-body {
    padding: 1rem;
  }
  .admin-stats-card h3 {
    font-size: 1.5rem;
  }
  .tabla-horarios {
    font-size: 0.8rem;
  }
  .clase-bloque {
    font-size: 0.65rem;
    padding: 2px 4px;
  }
  .professor-hero {
    padding: 32px 28px;
  }
  .professor-hero h2 {
    font-size: 1.6rem;
  }
  .professor-actions__header {
    flex-direction: column;
    align-items: flex-start;
  }
  .professor-actions-grid {
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  }
  .professor-layout {
    grid-template-columns: 1fr;
  }
  .professor-card {
    padding: 20px 22px;
  }
}
</style>
{% endblock %}

{% block content %}
<div class="right_col" role="main">
  <div class="container-fluid">
    <!-- Header de bienvenida -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="bg-white p-4 rounded shadow-sm border">
          <div class="row align-items-center">
            <div class="col-md-8">
              <div class="d-flex align-items-center">
                <div class="me-3">
                  <i class="fas fa-user-circle fa-3x text-primary"></i>
                </div>
                <div>
                  <h1 class="h3 mb-1 text-dark">¡Bienvenido, {{ user.first_name|default:user.username }}!</h1>
                  <p class="mb-0 text-muted">
                    <i class="fas fa-id-badge me-2"></i>
                    Tipo de usuario: <span class="badge bg-primary text-white px-2 py-1">{{ user.perfil.get_tipo_usuario_display }}</span>
                  </p>
                </div>
              </div>
            </div>
            <div class="col-md-4 text-end d-none d-md-block">
              <div class="text-center">
                <i class="fas fa-calendar-alt fa-2x text-muted mb-2"></i>
                <p class="mb-0 small text-muted" id="currentDateTime"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    {% if user.perfil.tipo_usuario == 'alumno' %}
    <!-- ################################################## -->
    <!-- ########## PANEL SIMPLIFICADO PARA ESTUDIANTES ######### -->
    <!-- ################################################## -->
    <div class="row">
      <!-- Panel Principal: Resumen Académico -->
      <div class="col-lg-8 mb-4">
        {% if estudiante %}
        <div class="student-dashboard fade-in">
          <section class="student-hero">
            <div class="student-hero__content">
              <div class="student-hero__icon">
                <i class="fas fa-user-graduate"></i>
              </div>
              <div>
                <span class="student-hero__chip"><i class="fas fa-graduation-cap"></i> Estudiante</span>
                <h2 class="student-hero__title">Hola, {{ estudiante.get_nombre_completo|default:user.get_full_name|default:user.username }}</h2>
                <p class="student-hero__subtitle">Sigue tu progreso académico y mantén tus clases bajo control.</p>
                <div class="student-hero__meta">
                  {% if curso_actual %}
                  <span><i class="fas fa-school"></i>{{ curso_actual.get_nivel_display }}{{ curso_actual.paralelo }}</span>
                  <span><i class="fas fa-calendar-alt"></i>{{ curso_actual.anio }}</span>
                  {% if curso_actual.profesor_jefe %}
                  <span><i class="fas fa-user-tie"></i>{{ curso_actual.profesor_jefe.get_nombre_completo|truncatechars:32 }}</span>
                  {% endif %}
                  {% endif %}
                  <span><i class="fas fa-id-card"></i>{{ estudiante.codigo_estudiante|default:"Sin código" }}</span>
                </div>
              </div>
            </div>
            <div class="student-hero__metrics">
              <div class="student-hero-metric">
                <span>Promedio general</span>
                {% if promedio_general %}
                <strong>{{ promedio_general|floatformat:1 }}</strong>
                {% else %}
                <strong>--</strong>
                {% endif %}
              </div>
              <div class="student-hero-metric">
                <span>Materias activas</span>
                <strong>{{ asignaturas.count|default:"0" }}</strong>
              </div>
              <div class="student-hero-metric">
                <span>Próximas clases</span>
                <strong>{{ proximos_horarios|length }}</strong>
              </div>
            </div>
          </section>

          <section class="student-section">
            <header class="student-section__header">
              <div>
                <h3>Resumen del periodo</h3>
                <p>Datos clave de tu desempeño actual.</p>
              </div>
            </header>
            <div class="student-kpi-grid">
              <article class="student-kpi-card student-kpi-card--gold">
                <i class="fas fa-calendar-check"></i>
                <div>
                  <span>Asistencia acumulada</span>
                  <strong>{{ porcentaje_asistencia|default:"0" }}%</strong>
                </div>
              </article>
              <article class="student-kpi-card student-kpi-card--green">
                <i class="fas fa-file-alt"></i>
                <div>
                  <span>Notas registradas</span>
                  <strong>{{ total_notas|default:"0" }}</strong>
                </div>
              </article>
              <article class="student-kpi-card student-kpi-card--blue">
                <i class="fas fa-user-check"></i>
                <div>
                  <span>Clases asistidas</span>
                  <strong>{{ presentes|default:"0" }}</strong>
                </div>
              </article>
              <article class="student-kpi-card student-kpi-card--violet">
                <i class="fas fa-sticky-note"></i>
                <div>
                  <span>Anotaciones recientes</span>
                  <strong>{{ anotaciones_recientes|length }}</strong>
                </div>
              </article>
            </div>
          </section>

          <section class="student-section">
            <header class="student-section__header">
              <div>
                <h3>Próximas clases</h3>
                <p>Lo que viene en los próximos días.</p>
              </div>
              <div>
                <a href="{% url 'mis_horarios' %}" class="btn btn-outline-primary btn-sm">
                  <i class="fas fa-calendar-alt me-1"></i>Ver horario completo
                </a>
              </div>
            </header>
            {% if proximos_horarios %}
            <div class="student-next-grid">
              {% for dia in proximos_horarios %}
              <div class="student-next-card">
                <div class="student-next-card__head">
                  <strong>{{ dia.dia_nombre }}</strong>
                  <span class="text-muted">{{ dia.fecha|date:"d/m" }}</span>
                </div>
                {% for horario in dia.horarios|slice:":4" %}
                <div class="student-next-card__item">
                  <span><i class="fas fa-book me-1 text-primary"></i>{{ horario.asignatura.nombre|default:"Sin asignatura"|truncatechars:22 }}</span>
                  {% if horario.asignatura.profesor_responsable %}
                  <small>{{ horario.asignatura.profesor_responsable.get_nombre_completo|truncatechars:28 }}</small>
                  {% endif %}
                  <div class="student-next-card__time">
                    <span>{{ horario.hora_inicio|time:"H:i" }}</span>
                    <span>{{ horario.hora_fin|time:"H:i" }}</span>
                  </div>
                </div>
                {% empty %}
                <div class="student-next-card__item student-weekly-empty">Sin clases programadas</div>
                {% endfor %}
              </div>
              {% endfor %}
            </div>
            {% else %}
            <div class="student-empty-state">
              <i class="fas fa-calendar-times"></i>
              <p>No tienes clases programadas para los próximos días.</p>
            </div>
            {% endif %}
          </section>

          {% if curso_actual %}
          <section class="student-section">
            <header class="student-section__header">
              <div>
                <h3>Horario semanal</h3>
                <p>{{ curso_actual.get_nivel_display }}{{ curso_actual.paralelo }} - {{ curso_actual.anio }}</p>
              </div>
            </header>
            {% if horario_tabla_estudiante %}
            <div class="student-weekly-table-wrapper">
              <table class="student-weekly-table tabla-horarios-detallada">
                <thead>
                  <tr>
                    <th class="student-weekly-hour"><i class="fas fa-clock me-1"></i>Hora</th>
                    {% for dia in dias_estudiante_tabla %}
                    <th class="student-weekly-day" data-dia="{{ dia.codigo }}">
                      <div class="dia-header">
                        <div class="dia-nombre">{{ dia.nombre }}</div>
                        <small class="dia-codigo">{{ dia.codigo }}</small>
                      </div>
                    </th>
                    {% endfor %}
                  </tr>
                </thead>
                <tbody>
                  {% for fila in horario_tabla_estudiante %}
                  <tr>
                    <td class="student-weekly-hour">{{ fila.hora }}</td>
                    {% for slot in fila.dias %}
                    <td class="student-weekly-cell" data-dia="{{ slot.codigo }}">
                      {% if slot.horario %}
                      <div class="student-weekly-slot">
                        <strong>{{ slot.horario.asignatura.nombre|default:"Sin asignatura"|truncatechars:18 }}</strong>
                        {% if slot.horario.asignatura.profesor_responsable %}
                        <small>{{ slot.horario.asignatura.profesor_responsable.get_nombre_completo|truncatechars:26 }}</small>
                        {% endif %}
                      </div>
                      {% else %}
                      <div class="student-weekly-empty"><i class="fas fa-minus"></i></div>
                      {% endif %}
                    </td>
                    {% endfor %}
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
            {% else %}
            <div class="student-empty-state">
              <i class="fas fa-info-circle"></i>
              <p>Tu curso aún no tiene horarios asignados.</p>
            </div>
            {% endif %}
          </section>
          {% endif %}

          <section class="student-section">
            <header class="student-section__header">
              <div>
                <h3>Accesos directos</h3>
                <p>Ingresa rápidamente a tus herramientas frecuentes.</p>
              </div>
            </header>
            <div class="student-quick-grid">
              <a href="{% url 'ver_notas_curso' %}" class="student-quick-card" style="background: linear-gradient(135deg, #2563eb, #1d4ed8);">
                <i class="fas fa-chart-line"></i>
                <strong>Mis notas</strong>
                <small>Consulta tus evaluaciones al instante.</small>
              </a>
              <a href="{% url 'mis_horarios' %}" class="student-quick-card" style="background: linear-gradient(135deg, #10b981, #0f766e);">
                <i class="fas fa-clock"></i>
                <strong>Mi horario</strong>
                <small>Revisa tus clases programadas.</small>
              </a>
              <a href="{% url 'libro_anotaciones' %}" class="student-quick-card" style="background: linear-gradient(135deg, #f97316, #ea580c);">
                <i class="fas fa-book-open"></i>
                <strong>Anotaciones</strong>
                <small>Repasa observaciones recientes.</small>
              </a>
            </div>
          </section>
        </div>
        {% else %}
        <div class="student-section student-empty-state">
          <i class="fas fa-exclamation-triangle"></i>
          <p>No se encontró información del estudiante asociada a este usuario.</p>
        </div>
        {% endif %}
      </div>
      <!-- Panel lateral del estudiante -->
      <div class="col-lg-4 mb-4">
        <div class="card border-0 shadow-sm mb-3">
          <div class="card-header bg-light border-0">
            <h6 class="mb-0">
              <i class="fas fa-history text-primary me-2"></i>Anotaciones recientes
            </h6>
          </div>
          <div class="card-body">
            {% if anotaciones_recientes %}
              <div class="professor-activity-list">
                {% for anotacion in anotaciones_recientes|slice:":4" %}
                <div class="professor-activity-item">
                  <div class="professor-activity-icon {% if anotacion.tipo == 'positiva' %}positive{% elif anotacion.tipo == 'negativa' %}negative{% else %}neutral{% endif %}">
                    {% if anotacion.tipo == 'positiva' %}
                      <i class="fas fa-thumbs-up"></i>
                    {% elif anotacion.tipo == 'negativa' %}
                      <i class="fas fa-thumbs-down"></i>
                    {% else %}
                      <i class="fas fa-minus"></i>
                    {% endif %}
                  </div>
                  <div>
                    <h6 class="mb-1">{{ anotacion.profesor_autor.get_nombre_completo|default:"Profesor"|truncatechars:34 }}</h6>
                    <p class="mb-1">{{ anotacion.contenido|truncatechars:70 }}</p>
                    <small class="text-muted">{{ anotacion.fecha_creacion|date:"d/m/Y H:i" }}</small>
                  </div>
                </div>
                {% endfor %}
              </div>
              <a href="{% url 'libro_anotaciones' %}" class="btn btn-outline-primary btn-sm mt-2">
                <i class="fas fa-book-open me-1"></i>Ver todas
              </a>
            {% else %}
              <div class="professor-empty">
                <i class="fas fa-clipboard-check fa-2x mb-2"></i>
                <p class="mb-0">No tienes anotaciones recientes.</p>
              </div>
            {% endif %}
          </div>
        </div>

        <div class="card border-0 shadow-sm">
          <div class="card-header bg-light border-0">
            <h6 class="mb-0">
              <i class="fas fa-id-badge text-secondary me-2"></i>Mi perfil
            </h6>
          </div>
          <div class="card-body">
            <div class="profesor-info-item">
              <small>Nombre completo</small>
              <p>{{ user.get_full_name|default:user.username }}</p>
            </div>
            <div class="profesor-info-item">
              <small>Correo</small>
              <p>{{ user.email|default:"No registrado" }}</p>
            </div>
            {% if curso_actual %}
            <div class="profesor-info-item">
              <small>Curso actual</small>
              <p>{{ curso_actual.get_nivel_display }}{{ curso_actual.paralelo }} - {{ curso_actual.anio }}</p>
            </div>
            {% endif %}
            <div class="profesor-info-item">
              <small>Último acceso</small>
              <p>{{ user.last_login|date:"d/m/Y H:i"|default:"Primer acceso" }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  {% elif user.perfil.tipo_usuario == 'profesor' %}
  <!-- ################################################## -->
  <!-- ########### PANEL ESPECÍFICO PARA PROFESORES ############### -->
  <!-- ################################################## -->

  <div class="professor-dashboard fade-in">
                    <section class="professor-hero">
                      <span class="professor-chip"><i class="fas fa-chalkboard-teacher"></i> Docente</span>
                      <h2>Hola, {{ user.get_full_name|default:user.username }}</h2>
                      <p>Organiza tus clases, estudiantes y anotaciones desde un mismo lugar.</p>
                      <div class="professor-hero__meta">
                        <div class="professor-meta-pill">
                          <i class="fas fa-users"></i>
                          <div>
                            <strong>{{ total_estudiantes|default:"0" }}</strong>
                            <span>Estudiantes</span>
                          </div>
                        </div>
                        <div class="professor-meta-pill">
                          <i class="fas fa-clock"></i>
                          <div>
                            <strong>{{ proximos_horarios_profesor|length|default:"0" }}</strong>
                            <span>Próximas clases</span>
                          </div>
                        </div>
                        <div class="professor-meta-pill">
                          <i class="fas fa-book"></i>
                          <div>
                            <strong>{{ asignaturas_profesor.count|default:"0" }}</strong>
                            <span>Asignaturas</span>
                          </div>
                        </div>
                      </div>
                    </section>

                    <div class="professor-metrics-grid">
                      <div class="professor-metric-card metric-students">
                        <div class="metric-icon"><i class="fas fa-users"></i></div>
                        <span class="metric-label">Estudiantes a cargo</span>
                        <span class="metric-value">{{ total_estudiantes|default:"0" }}</span>
                        <p class="metric-note">Distribuidos en tus cursos activos.</p>
                      </div>
                      <div class="professor-metric-card metric-subjects">
                        <div class="metric-icon"><i class="fas fa-book-open"></i></div>
                        <span class="metric-label">Asignaturas activas</span>
                        <span class="metric-value">{{ asignaturas_profesor.count|default:"0" }}</span>
                        <p class="metric-note">Actualiza contenidos y seguimiento.</p>
                      </div>
                      <div class="professor-metric-card metric-courses">
                        <div class="metric-icon"><i class="fas fa-school"></i></div>
                        <span class="metric-label">Cursos asignados</span>
                        <span class="metric-value">{{ cursos_con_asignaturas.count|default:"0" }}</span>
                        <p class="metric-note">Incluye jefaturas y asignaturas.</p>
                      </div>
                      <div class="professor-metric-card metric-notes">
                        <div class="metric-icon"><i class="fas fa-sticky-note"></i></div>
                        <span class="metric-label">Anotaciones creadas</span>
                        <span class="metric-value">{{ stats_anotaciones.total|default:"0" }}</span>
                        <p class="metric-note">Registros en el libro digital.</p>
                      </div>
                    </div>

                    <section class="professor-actions">
                      <div class="professor-actions__header">
                        <h3><i class="fas fa-rocket text-primary"></i>Accesos rápidos</h3>
                        <p>Gestiona tus tareas diarias sin perder el ritmo.</p>
                      </div>
                      <div class="professor-actions-grid">
                        <a href="{% url 'crear_anotacion' %}" class="professor-action-card" style="--professor-action-color:#16a34a;">
                          <i class="fas fa-plus-circle"></i>
                          <h6>Crear anotación</h6>
                          <small>Registra observaciones en segundos.</small>
                        </a>
                        <a href="{% url 'libro_anotaciones' %}" class="professor-action-card" style="--professor-action-color:#2563eb;">
                          <i class="fas fa-book-open"></i>
                          <h6>Libro de anotaciones</h6>
                          <small>Revisa históricos y filtros personalizados.</small>
                        </a>
                        <a href="{% url 'listar_cursos' %}" class="professor-action-card" style="--professor-action-color:#f97316;">
                          <i class="fas fa-users"></i>
                          <h6>Mis cursos</h6>
                          <small>Visualiza jefaturas y estudiantes.</small>
                        </a>
                        <a href="{% url 'listar_asignaturas' %}" class="professor-action-card" style="--professor-action-color:#6366f1;">
                          <i class="fas fa-book"></i>
                          <h6>Mis asignaturas</h6>
                          <small>Accede a contenidos y calificaciones.</small>
                        </a>
                        <a href="{% url 'ver_notas_curso' %}" class="professor-action-card" style="--professor-action-color:#0ea5e9;">
                          <i class="fas fa-chart-line"></i>
                          <h6>Ver notas</h6>
                          <small>Consulta avances y promedios.</small>
                        </a>
                        <a href="{% url 'calendario' %}" class="professor-action-card" style="--professor-action-color:#ef4444;">
                          <i class="fas fa-calendar-alt"></i>
                          <h6>Calendario</h6>
                          <small>Planifica eventos y evaluaciones.</small>
                        </a>
                      </div>
                    </section>

                    {% if profesor %}
                    <div class="professor-layout">
                      <div class="professor-main">
                        {% if cursos_jefe %}
                        <div class="professor-card">
                          <div class="professor-card__header">
                            <h3 class="professor-card__title"><i class="fas fa-user-tie text-primary"></i>Jefatura de curso</h3>
                            <span class="professor-card__badge">{{ cursos_jefe|length }} curso{{ cursos_jefe|length|pluralize:",s" }}</span>
                          </div>
                          <div class="professor-tile-grid">
                            {% for curso in cursos_jefe %}
                            <div class="professor-tile">
                              <p class="professor-tile__title">{{ curso.get_nivel_display }}{{ curso.paralelo }}</p>
                              <p class="professor-tile__meta"><i class="fas fa-users me-1"></i>{{ curso.estudiantes.count }} estudiante{{ curso.estudiantes.count|pluralize:",s" }}</p>
                              <a href="{% url 'listar_cursos' %}#curso-{{ curso.id }}" class="btn btn-outline-primary btn-sm w-100">
                                <i class="fas fa-eye me-1"></i>Ver detalles
                              </a>
                            </div>
                            {% endfor %}
                          </div>
                        </div>
                        {% endif %}

                        {% if cursos_con_asignaturas %}
                        <div class="professor-card">
                          <div class="professor-card__header">
                            <h3 class="professor-card__title"><i class="fas fa-layer-group text-primary"></i>Mis cursos</h3>
                            <span class="professor-card__badge">{{ cursos_con_asignaturas|length }} activo{{ cursos_con_asignaturas|length|pluralize:",s" }}</span>
                          </div>
                          <div class="professor-course-grid">
                            {% for curso in cursos_con_asignaturas %}
                            <div class="professor-course-card">
                              <div class="professor-course-card__head">
                                <span class="professor-course-pill">{{ curso.get_nivel_display }}{{ curso.paralelo }}</span>
                                {% if profesor and curso.profesor_jefe_id == profesor.id %}
                                  <span class="professor-course-badge">Profesor jefe</span>
                                {% endif %}
                              </div>
                              <div class="professor-course-meta">
                                <span><i class="fas fa-calendar text-primary"></i>{{ curso.anio }}</span>
                                {% if curso.profesor_jefe %}
                                <span><i class="fas fa-user text-secondary"></i>{{ curso.profesor_jefe.get_nombre_completo|truncatechars:26 }}</span>
                                {% endif %}
                              </div>
                              <div class="professor-course-card__body">
                                <div class="professor-course-stat">
                                  <i class="fas fa-user-graduate"></i>
                                  <div>
                                    {% with total_estudiantes=curso.estudiantes_total|default:curso.estudiantes.count %}
                                    <strong>{{ total_estudiantes }}</strong>
                                    <span>Estudiantes</span>
                                    {% endwith %}
                                  </div>
                                </div>
                                <div class="professor-course-stat">
                                  <i class="fas fa-book"></i>
                                  <div>
                                    <strong>{{ curso.mis_asignaturas_count|default:"0" }}</strong>
                                    <span>Mis asignaturas</span>
                                  </div>
                                </div>
                              </div>
                              <div class="professor-course-actions">
                                <a href="{% url 'listar_cursos' %}#curso-{{ curso.id }}"><i class="fas fa-eye me-1"></i>Ver curso</a>
                                <a href="{% url 'listar_asignaturas' %}?curso={{ curso.id }}"><i class="fas fa-book-open me-1"></i>Asignaturas</a>
                              </div>
                            </div>
                            {% endfor %}
                          </div>
                        </div>
                        {% endif %}

                        {% if asignaturas_profesor %}
                        <div class="professor-card">
                          <div class="professor-card__header">
                            <h3 class="professor-card__title"><i class="fas fa-book me-2 text-primary"></i>Mis asignaturas</h3>
                            <span class="professor-card__badge">{{ asignaturas_profesor.count }} activa{{ asignaturas_profesor.count|pluralize:",s" }}</span>
                          </div>
                          <div class="professor-subject-grid">
                            {% for asignatura in asignaturas_profesor|slice:":6" %}
                            <div class="professor-subject-card">
                              <h6>{{ asignatura.nombre|truncatechars:26 }}</h6>
                              <span>{{ asignatura.codigo|default:"Sin código" }}</span>
                            </div>
                            {% endfor %}
                          </div>
                          {% if asignaturas_profesor.count > 6 %}
                          <a href="{% url 'listar_asignaturas' %}" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-list"></i> Ver todas ({{ asignaturas_profesor.count }})
                          </a>
                          {% endif %}
                        </div>
                        {% endif %}

                        {% if proximos_horarios_profesor %}
                        <div class="professor-card">
                          <div class="professor-card__header">
                            <h3 class="professor-card__title"><i class="fas fa-clock text-primary"></i>Próximas clases</h3>
                            <span class="professor-card__badge">{{ proximos_horarios_profesor|length }} jornada{{ proximos_horarios_profesor|length|pluralize:",s" }}</span>
                          </div>
                          <div class="professor-schedule-grid">
                            {% for dia in proximos_horarios_profesor %}
                            <div class="professor-schedule-card">
                              <div class="professor-schedule-card__head">
                                <h6>{{ dia.dia_nombre }}</h6>
                                <small>{{ dia.fecha|date:"d/m" }}</small>
                              </div>
                              <div class="professor-schedule-list">
                                {% for horario in dia.horarios|slice:":3" %}
                                <div class="professor-schedule-item">
                                  <div>
                                    <div class="professor-schedule-item__title">{{ horario.asignatura.nombre|truncatechars:24 }}</div>
                                    <div class="text-muted small">{{ horario.curso.get_nivel_display }}{{ horario.curso.paralelo }}</div>
                                  </div>
                                  <div class="professor-schedule-item__meta">
                                    <span>{{ horario.hora_inicio|time:"H:i" }}</span>
                                  </div>
                                </div>
                                {% empty %}
                                <div class="text-muted small">Sin horarios registrados.</div>
                                {% endfor %}
                              </div>
                            </div>
                            {% endfor %}
                          </div>
                        </div>
                        {% endif %}

                        <div class="professor-card">
                          <div class="professor-card__header">
                            <h3 class="professor-card__title"><i class="fas fa-chart-pie text-primary"></i>Resumen de anotaciones</h3>
                            <span class="professor-card__badge">{{ stats_anotaciones.total|default:"0" }} total</span>
                          </div>
                          <p class="text-muted mb-0">Sigue el pulso de las anotaciones registradas durante el año.</p>
                          <div class="professor-annotation-stats">
                            <div class="professor-annotation-pill total">
                              <strong>{{ stats_anotaciones.total|default:"0" }}</strong>
                              <span>Total registradas</span>
                            </div>
                            <div class="professor-annotation-pill positive">
                              <strong>{{ stats_anotaciones.positivas|default:"0" }}</strong>
                              <span>Positivas</span>
                            </div>
                            <div class="professor-annotation-pill neutral">
                              <strong>{{ stats_anotaciones.neutras|default:"0" }}</strong>
                              <span>Neutras</span>
                            </div>
                            <div class="professor-annotation-pill negative">
                              <strong>{{ stats_anotaciones.negativas|default:"0" }}</strong>
                              <span>Negativas</span>
                            </div>
                          </div>
                        </div>
                      </div>

                      <aside class="professor-side">
                        <div class="professor-card">
                          <div class="professor-card__header">
                            <h3 class="professor-card__title"><i class="fas fa-history text-primary"></i>Actividad reciente</h3>
                            <span class="professor-card__badge">{{ anotaciones_recientes|length|default:"0" }} registro{{ anotaciones_recientes|length|default:"0"|pluralize:",s" }}</span>
                          </div>
                          {% if anotaciones_recientes %}
                          <div class="professor-activity-list">
                            {% for anotacion in anotaciones_recientes|slice:":4" %}
                            <div class="professor-activity-item">
                              <div class="professor-activity-icon {% if anotacion.tipo == 'positiva' %}positive{% elif anotacion.tipo == 'negativa' %}negative{% else %}neutral{% endif %}">
                                {% if anotacion.tipo == 'positiva' %}
                                  <i class="fas fa-thumbs-up"></i>
                                {% elif anotacion.tipo == 'negativa' %}
                                  <i class="fas fa-thumbs-down"></i>
                                {% else %}
                                  <i class="fas fa-minus"></i>
                                {% endif %}
                              </div>
                              <div>
                                <h6>
                                  {% if anotacion.estudiante %}
                                    {{ anotacion.estudiante.get_nombre_completo|truncatechars:32 }}
                                  {% else %}
                                    {{ anotacion.curso.get_nivel_display }}{{ anotacion.curso.paralelo }} (General)
                                  {% endif %}
                                </h6>
                                <p>{{ anotacion.contenido|truncatechars:70 }}</p>
                                <small class="text-muted">{{ anotacion.fecha_creacion|date:"d/m/Y H:i" }}</small>
                              </div>
                            </div>
                            {% endfor %}
                          </div>
                          <a href="{% url 'libro_anotaciones' %}" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-eye"></i> Ver libro completo
                          </a>
                          {% else %}
                          <div class="professor-empty">
                            <i class="fas fa-clipboard-check fa-2x mb-2"></i>
                            <p class="mb-0">Sin anotaciones recientes en los últimos días.</p>
                          </div>
                          {% endif %}
                        </div>

                        <div class="professor-card">
                          <div class="professor-card__header">
                            <h3 class="professor-card__title"><i class="fas fa-id-badge text-primary"></i>Información personal</h3>
                          </div>
                          <div class="profesor-info-item">
                            <small>Nombre completo</small>
                            <p>{{ user.get_full_name|default:user.username }}</p>
                          </div>
                          <div class="profesor-info-item">
                            <small>Email institucional</small>
                            <p>{{ user.email|default:"No registrado" }}</p>
                          </div>
                          {% if profesor %}
                          <div class="profesor-info-item">
                            <small>RUT</small>
                            <p>{{ profesor.rut|default:"No registrado" }}</p>
                          </div>
                          {% endif %}
                          <div class="profesor-info-item">
                            <small>Último acceso</small>
                            <p>{{ user.last_login|date:"d/m/Y H:i"|default:"Primer acceso" }}</p>
                          </div>
                        </div>
                      </aside>
                    </div>
                    {% else %}
                    <div class="professor-empty">
                      <i class="fas fa-exclamation-triangle fa-2x mb-2 text-warning"></i>
                      <p class="mb-1">No encontramos información del profesor asociada a este usuario.</p>
                      <small>Contacta al administrador para verificar tus credenciales.</small>
                    </div>
                    {% endif %}
                  </div>
    {% elif user.perfil.tipo_usuario == 'director' %}
    <!-- ################################################## -->
    <!-- ######### PANEL RENOVADO PARA DIRECTORES ######### -->
    <!-- ################################################## -->

    <div class="director-dashboard fade-in">
      <div class="director-dashboard__kpis">
        <div class="card director-kpi-card">
          <span class="director-kpi-icon"><i class="fas fa-user-graduate"></i></span>
          <div class="card-body">
            <p class="mb-1 director-kpi-label">Estudiantes</p>
            <div class="director-kpi-value">{{ total_estudiantes_sistema|default:"0" }}</div>
            <small class="text-white-50">Total en plataforma</small>
          </div>
        </div>
        <div class="card director-kpi-card director-kpi-success">
          <span class="director-kpi-icon"><i class="fas fa-chalkboard-teacher"></i></span>
          <div class="card-body">
            <p class="mb-1 director-kpi-label">Profesores</p>
            <div class="director-kpi-value">{{ total_profesores_sistema|default:"0" }}</div>
            <small class="text-white-50">Docentes activos</small>
          </div>
        </div>
        <div class="card director-kpi-card director-kpi-warning">
          <span class="director-kpi-icon"><i class="fas fa-school"></i></span>
          <div class="card-body">
            <p class="mb-1 director-kpi-label">Cursos {{ anio_actual }}</p>
            <div class="director-kpi-value">{{ total_cursos_activos|default:"0" }}</div>
            <small class="text-white-50">Secciones vigentes</small>
          </div>
        </div>
        <div class="card director-kpi-card director-kpi-info">
          <span class="director-kpi-icon"><i class="fas fa-calendar-check"></i></span>
          <div class="card-body">
            <p class="mb-1 director-kpi-label">Asistencia Hoy</p>
            <div class="director-kpi-value">{{ porcentaje_asistencia_hoy|default:"0" }}%</div>
            <small class="text-white-50">{{ presentes_hoy|default:"0" }} presentes de {{ total_asistencias_hoy|default:"0" }}</small>
          </div>
        </div>
      </div>

      <div class="director-dashboard__content">
        <div class="director-main-column">
          <div class="card director-card director-card--panorama">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center">
                <span class="director-section-title">Panorama Diario</span>
                <span class="director-pill-count">Año {{ anio_actual }}</span>
              </div>

              {% if total_asistencias_hoy > 0 %}
              <div>
                <div class="d-flex justify-content-between align-items-center">
                  <h5 class="mb-0 text-dark">Asistencia de hoy</h5>
                  <span class="badge bg-light text-dark">{{ total_asistencias_hoy }} registros</span>
                </div>
                <div class="progress director-progress mt-2">
                  <div class="progress-bar bg-success director-progress-bar" role="progressbar" style="--progress-value: {{ porcentaje_asistencia_hoy|default_if_none:0|floatformat:0 }};" aria-valuenow="{{ porcentaje_asistencia_hoy|default_if_none:0 }}" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="d-flex justify-content-between small text-muted mt-2">
                  <span>Presentes: {{ presentes_hoy|default:"0" }}</span>
                  <span>Ausentes: {{ ausentes_hoy|default:"0" }}</span>
                  <span>{{ porcentaje_asistencia_hoy|default:"0" }}%</span>
                </div>
              </div>
              {% else %}
              <div class="director-empty-state">
                <div class="text-center">
                  <i class="fas fa-clipboard-list fa-2x mb-2"></i>
                  <p class="mb-0 small">Aún no hay registros de asistencia para hoy</p>
                </div>
              </div>
              {% endif %}

              <div class="d-flex justify-content-between align-items-center">
                <span class="director-section-title">Oferta por nivel</span>
                <span class="text-muted small">Distribución de cursos y matrícula</span>
              </div>
              {% if cursos_por_nivel %}
              <div class="row g-2">
                {% for nivel, stats in cursos_por_nivel.items %}
                <div class="col-sm-6">
                  <div class="director-mini-card h-100">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                      <span class="fw-semibold text-dark">{{ nivel }}</span>
                      <span class="director-pill-count">{{ stats.cursos }} curso{{ stats.cursos|pluralize:",s" }}</span>
                    </div>
                    <p class="mb-0 small text-muted">{{ stats.estudiantes }} estudiante{{ stats.estudiantes|pluralize:",s" }}</p>
                  </div>
                </div>
                {% endfor %}
              </div>
              {% else %}
              <div class="director-mini-card text-center text-muted">
                <i class="fas fa-layer-group me-2"></i>No hay cursos registrados para {{ anio_actual }}
              </div>
              {% endif %}
            </div>
          </div>

          <div class="card director-card director-card--activity">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center">
                <span class="director-section-title">Actividad reciente</span>
                <span class="text-muted small">Actualizado automáticamente</span>
              </div>
              <div class="row g-2 flex-grow-1">
                <div class="col-md-4">
                  <div class="director-mini-card h-100">
                    <h6 class="fw-semibold text-dark mb-2"><i class="fas fa-school me-2 text-primary"></i>Cursos</h6>
                    {% if cursos_recientes %}
                      {% for curso in cursos_recientes|slice:":4" %}
                      <div class="director-activity-item">
                        <p class="mb-1 small fw-semibold">{{ curso.get_nivel_display }}{{ curso.paralelo }}</p>
                        <small class="text-muted">{{ curso.estudiantes.count }} estudiante{{ curso.estudiantes.count|pluralize:",s" }}</small>
                      </div>
                      {% endfor %}
                    {% else %}
                      <p class="mb-0 small text-muted">Sin registros recientes</p>
                    {% endif %}
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="director-mini-card h-100">
                    <h6 class="fw-semibold text-dark mb-2"><i class="fas fa-chalkboard me-2 text-success"></i>Profesores</h6>
                    {% if profesores_recientes %}
                      {% for profesor in profesores_recientes|slice:":4" %}
                      <div class="director-activity-item">
                        <p class="mb-1 small fw-semibold">{{ profesor.get_nombre_completo|truncatechars:22 }}</p>
                        <small class="text-muted">{{ profesor.asignaturas.count }} asignatura{{ profesor.asignaturas.count|pluralize:",s" }}</small>
                      </div>
                      {% endfor %}
                    {% else %}
                      <p class="mb-0 small text-muted">Sin registros recientes</p>
                    {% endif %}
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="director-mini-card h-100">
                    <h6 class="fw-semibold text-dark mb-2"><i class="fas fa-user-friends me-2 text-warning"></i>Estudiantes</h6>
                    {% if estudiantes_recientes %}
                      {% for estudiante in estudiantes_recientes|slice:":4" %}
                      <div class="director-activity-item">
                        <p class="mb-1 small fw-semibold">{{ estudiante.get_nombre_completo|truncatechars:22 }}</p>
                        {% if estudiante.cursos.exists %}
                          <small class="text-muted">{{ estudiante.cursos.first.get_nivel_display }}{{ estudiante.cursos.first.paralelo }}</small>
                        {% else %}
                          <small class="text-muted">Sin curso asignado</small>
                        {% endif %}
                      </div>
                      {% endfor %}
                    {% else %}
                      <p class="mb-0 small text-muted">Sin registros recientes</p>
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="director-side-column">
          <div class="card director-card director-card--events">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center">
                <span class="director-section-title">Próximos eventos</span>
                <a href="{% url 'calendario' %}" class="btn btn-sm btn-outline-primary">
                  <i class="fas fa-calendar-week me-1"></i>Calendario
                </a>
              </div>
              <div class="director-scroll-area">
                {% if proximos_eventos %}
                <div class="director-timeline">
                  {% for evento in proximos_eventos %}
                  <div class="director-timeline-item">
                    <span class="director-timeline-bullet"></span>
                    <h6 class="mb-1">{{ evento.titulo|truncatechars:28 }}</h6>
                    <p class="mb-1 small text-muted">{{ evento.descripcion|default:"Sin descripción"|truncatechars:60 }}</p>
                    <small class="text-muted"><i class="fas fa-clock me-1"></i>{{ evento.fecha|date:"d/m/Y" }}</small>
                  </div>
                  {% endfor %}
                </div>
                {% else %}
                <div class="director-empty-state">
                  <div class="text-center">
                    <i class="fas fa-calendar-times fa-2x mb-2"></i>
                    <p class="mb-0 small">No hay eventos en los próximos 7 días</p>
                  </div>
                </div>
                {% endif %}
              </div>
            </div>
          </div>

          <div class="card director-card director-card--annotations">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center">
                <span class="director-section-title">Anotaciones</span>
                <a href="{% url 'libro_anotaciones' %}" class="btn btn-sm btn-outline-secondary">Ver todas</a>
              </div>
              <div class="director-scroll-area">
                {% if anotaciones_recientes_sistema %}
                <div class="director-timeline">
                  {% for anotacion in anotaciones_recientes_sistema|slice:":5" %}
                  <div class="director-timeline-item">
                    <span class="director-timeline-bullet"></span>
                    <p class="mb-1 small fw-semibold">
                      {% if anotacion.estudiante %}
                        {{ anotacion.estudiante.get_nombre_completo|truncatechars:24 }}
                      {% else %}
                        {{ anotacion.curso.get_nivel_display }}{{ anotacion.curso.paralelo }}
                      {% endif %}
                    </p>
                    <p class="mb-1 small text-muted">{{ anotacion.contenido|truncatechars:65 }}</p>
                    <small class="text-muted">Por {{ anotacion.profesor_autor.get_nombre_completo|truncatechars:18 }}</small>
                  </div>
                  {% endfor %}
                </div>
                {% else %}
                <div class="director-empty-state">
                  <div class="text-center">
                    <i class="fas fa-comment-dots fa-2x mb-2"></i>
                    <p class="mb-0 small">No hay anotaciones recientes</p>
                  </div>
                </div>
                {% endif %}
              </div>
            </div>
          </div>

          <div class="card director-card director-card--quick">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center">
                <span class="director-section-title">Gestión rápida</span>
                <span class="text-muted small">Accesos frecuentes</span>
              </div>
              <div class="director-quick-actions">
                <a href="{% url 'listar_estudiantes' %}" class="text-decoration-none">
                  <div class="director-mini-card text-center">
                    <i class="fas fa-users fa-2x text-primary mb-2"></i>
                    <h6 class="mb-1">Estudiantes</h6>
                    <small class="text-muted">Listado y gestión</small>
                  </div>
                </a>
                <a href="{% url 'listar_estudiantes' %}?tipo=profesor" class="text-decoration-none">
                  <div class="director-mini-card text-center">
                    <i class="fas fa-chalkboard-teacher fa-2x text-success mb-2"></i>
                    <h6 class="mb-1">Profesores</h6>
                    <small class="text-muted">Asignaciones y datos</small>
                  </div>
                </a>
                <a href="{% url 'listar_cursos' %}" class="text-decoration-none">
                  <div class="director-mini-card text-center">
                    <i class="fas fa-school fa-2x text-warning mb-2"></i>
                    <h6 class="mb-1">Cursos</h6>
                    <small class="text-muted">Oferta académica</small>
                  </div>
                </a>
                <a href="{% url 'listar_asignaturas' %}" class="text-decoration-none">
                  <div class="director-mini-card text-center">
                    <i class="fas fa-book fa-2x text-info mb-2"></i>
                    <h6 class="mb-1">Asignaturas</h6>
                    <small class="text-muted">Planificación y docentes</small>
                  </div>
                </a>
                <a href="{% url 'agregar' %}" class="text-decoration-none">
                  <div class="director-mini-card text-center">
                    <i class="fas fa-user-plus fa-2x text-danger mb-2"></i>
                    <h6 class="mb-1">Nuevo usuario</h6>
                    <small class="text-muted">Alta rápida</small>
                  </div>
                </a>
                <a href="{% url 'calendario' %}" class="text-decoration-none">
                  <div class="director-mini-card text-center">
                    <i class="fas fa-calendar-check fa-2x text-secondary mb-2"></i>
                    <h6 class="mb-1">Calendario</h6>
                    <small class="text-muted">Eventos y hitos</small>
                  </div>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    {% elif user.perfil.tipo_usuario == 'administrador' %}
    <!-- ################################################## -->
    <!-- ######### PANEL ESPECÍFICO PARA ADMINISTRADORES ######### -->
    <!-- ################################################## -->

    <!-- Estadísticas principales del sistema -->
    <div class="row mb-4 fade-in">
      <div class="col-md-3 mb-3">
        <div class="card border-0 shadow-sm bg-primary text-white h-100 admin-stats-card">
          <div class="card-body text-center">
            <i class="fas fa-user-graduate fa-2x mb-2 opacity-75"></i>
            <h3 class="mb-1">{{ total_estudiantes_sistema|default:"0" }}</h3>
            <small>Estudiantes Totales</small>
          </div>
        </div>
      </div>
      <div class="col-md-3 mb-3">
        <div class="card border-0 shadow-sm bg-success text-white h-100 admin-stats-card">
          <div class="card-body text-center">
            <i class="fas fa-chalkboard-teacher fa-2x mb-2 opacity-75"></i>
            <h3 class="mb-1">{{ total_profesores_sistema|default:"0" }}</h3>
            <small>Profesores Activos</small>
          </div>
        </div>
      </div>
      <div class="col-md-3 mb-3">
        <div class="card border-0 shadow-sm bg-warning text-white h-100 admin-stats-card">
          <div class="card-body text-center">
            <i class="fas fa-school fa-2x mb-2 opacity-75"></i>
            <h3 class="mb-1">{{ total_cursos_activos|default:"0" }}</h3>
            <small>Cursos {{ anio_actual }}</small>
          </div>
        </div>
      </div>
      <div class="col-md-3 mb-3">
        <div class="card border-0 shadow-sm bg-info text-white h-100 admin-stats-card">
          <div class="card-body text-center">
            <i class="fas fa-book fa-2x mb-2 opacity-75"></i>
            <h3 class="mb-1">{{ total_asignaturas_sistema|default:"0" }}</h3>
            <small>Asignaturas</small>
          </div>
        </div>
      </div>
    </div>

    <!-- Panel de accesos rápidos para administradores -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card border-0 shadow-sm">
          <div class="card-header bg-light border-0">
            <h4 class="mb-0 text-dark">
              <i class="fas fa-cogs text-primary me-2"></i>Panel de Administración
            </h4>
          </div>
          <div class="card-body">
            <div class="row g-3">
              <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                <a href="{% url 'listar_estudiantes' %}" class="quick-access-link text-decoration-none">
                  <div class="quick-access-card text-center p-3 rounded-3 h-100 border">
                    <i class="fas fa-users fa-2x text-primary mb-2"></i>
                    <h6 class="mb-0">Gestionar Estudiantes</h6>
                  </div>
                </a>
              </div>
              <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                <a href="{% url 'listar_estudiantes' %}?tipo=profesor" class="quick-access-link text-decoration-none">
                  <div class="quick-access-card text-center p-3 rounded-3 h-100 border">
                    <i class="fas fa-chalkboard-teacher fa-2x text-success mb-2"></i>
                    <h6 class="mb-0">Gestionar Profesores</h6>
                  </div>
                </a>
              </div>
              <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                <a href="{% url 'listar_cursos' %}" class="quick-access-link text-decoration-none">
                  <div class="quick-access-card text-center p-3 rounded-3 h-100 border">
                    <i class="fas fa-school fa-2x text-warning mb-2"></i>
                    <h6 class="mb-0">Gestionar Cursos</h6>
                  </div>
                </a>
              </div>
              <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                <a href="{% url 'listar_asignaturas' %}" class="quick-access-link text-decoration-none">
                  <div class="quick-access-card text-center p-3 rounded-3 h-100 border">
                    <i class="fas fa-book fa-2x text-info mb-2"></i>
                    <h6 class="mb-0">Gestionar Asignaturas</h6>
                  </div>
                </a>
              </div>
              <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                <a href="{% url 'agregar' %}" class="quick-access-link text-decoration-none">
                  <div class="quick-access-card text-center p-3 rounded-3 h-100 border">
                    <i class="fas fa-user-plus fa-2x text-danger mb-2"></i>
                    <h6 class="mb-0">Agregar Usuario</h6>
                  </div>
                </a>
              </div>
              <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                <a href="{% url 'calendario' %}" class="quick-access-link text-decoration-none">
                  <div class="quick-access-card text-center p-3 rounded-3 h-100 border">
                    <i class="fas fa-calendar-check fa-2x text-secondary mb-2"></i>
                    <h6 class="mb-0">Calendario</h6>
                  </div>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Panel principal del sistema -->
    <div class="row">
      <!-- Información del sistema -->
      <div class="col-lg-8 mb-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-light border-0">
            <h5 class="mb-0 text-dark">
              <i class="fas fa-chart-line text-primary me-2"></i>Estado del Sistema
            </h5>
          </div>
          <div class="card-body">
            {% if not error_admin %}
            
            <!-- Asistencia de hoy -->
            <div class="mb-4">
              <h6 class="text-muted mb-3">
                <i class="fas fa-calendar-day me-1"></i>Asistencia de Hoy
              </h6>
              {% if total_asistencias_hoy > 0 %}
              <div class="row g-2">
                <div class="col-md-4">
                  <div class="text-center p-3 bg-success text-white rounded">
                    <h5 class="mb-1">{{ presentes_hoy }}</h5>
                    <small>Presentes</small>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="text-center p-3 bg-danger text-white rounded">
                    <h5 class="mb-1">{{ ausentes_hoy|default:"0" }}</h5>
                    <small>Ausentes</small>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="text-center p-3 bg-info text-white rounded">
                    <h5 class="mb-1">{{ porcentaje_asistencia_hoy }}%</h5>
                    <small>Porcentaje</small>
                  </div>
                </div>
              </div>
              {% else %}
              <div class="alert alert-info text-center">
                <i class="fas fa-info-circle me-2"></i>No hay registros de asistencia para hoy
              </div>
              {% endif %}
            </div>

            <!-- Distribución por niveles -->
            {% if cursos_por_nivel %}
            <div class="mb-4">
              <h6 class="text-muted mb-3">
                <i class="fas fa-layer-group me-1"></i>Distribución por Niveles
              </h6>
              <div class="row g-2">
                {% for nivel, stats in cursos_por_nivel.items %}
                <div class="col-md-6 col-lg-4">
                  <div class="card border h-100">
                    <div class="card-body p-3 text-center">
                      <h6 class="mb-1">{{ nivel }}</h6>
                      <p class="mb-1 small text-muted">{{ stats.cursos }} curso{{ stats.cursos|pluralize:",s" }}</p>
                      <p class="mb-0 text-primary"><strong>{{ stats.estudiantes }} estudiantes</strong></p>
                    </div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
            {% endif %}

            <!-- Estadísticas de anotaciones del sistema -->
            <div class="mb-4">
              <h6 class="text-muted mb-3">
                <i class="fas fa-sticky-note me-1"></i>Anotaciones del Sistema
              </h6>
              <div class="row g-2">
                <div class="col-md-3">
                  <div class="text-center p-2 bg-success text-white rounded">
                    <h6 class="mb-0">{{ stats_anotaciones_sistema.positivas }}</h6>
                    <small>Positivas</small>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="text-center p-2 bg-warning text-white rounded">
                    <h6 class="mb-0">{{ stats_anotaciones_sistema.neutras }}</h6>
                    <small>Neutras</small>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="text-center p-2 bg-danger text-white rounded">
                    <h6 class="mb-0">{{ stats_anotaciones_sistema.negativas }}</h6>
                    <small>Negativas</small>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="text-center p-2 bg-secondary text-white rounded">
                    <h6 class="mb-0">{{ stats_anotaciones_sistema.total }}</h6>
                    <small>Total</small>
                  </div>
                </div>
              </div>
            </div>

            <!-- Actividades recientes -->
            <div class="mb-4">
              <h6 class="text-muted mb-3">
                <i class="fas fa-clock me-1"></i>Actividad Reciente
              </h6>
              <div class="row g-2">
                {% if cursos_recientes %}
                <div class="col-md-4">
                  <div class="card border h-100">
                    <div class="card-header bg-light py-2">
                      <h6 class="mb-0 small">Cursos Recientes</h6>
                    </div>
                    <div class="card-body py-2">
                      {% for curso in cursos_recientes|slice:":3" %}
                      <div class="small mb-1">
                        <strong>{{ curso.get_nivel_display }}{{ curso.paralelo }}</strong>
                        <br><small class="text-muted">{{ curso.estudiantes.count }} estudiantes</small>
                      </div>
                      {% if not forloop.last %}<hr class="my-1">{% endif %}
                      {% endfor %}
                    </div>
                  </div>
                </div>
                {% endif %}
                
                {% if profesores_recientes %}
                <div class="col-md-4">
                  <div class="card border h-100">
                    <div class="card-header bg-light py-2">
                      <h6 class="mb-0 small">Profesores Recientes</h6>
                    </div>
                    <div class="card-body py-2">
                      {% for profesor in profesores_recientes|slice:":3" %}
                      <div class="small mb-1">
                        <strong>{{ profesor.get_nombre_completo|truncatechars:20 }}</strong>
                        <br><small class="text-muted">{{ profesor.asignaturas.count }} asignatura{{ profesor.asignaturas.count|pluralize:",s" }}</small>
                      </div>
                      {% if not forloop.last %}<hr class="my-1">{% endif %}
                      {% endfor %}
                    </div>
                  </div>
                </div>
                {% endif %}
                
                {% if estudiantes_recientes %}
                <div class="col-md-4">
                  <div class="card border h-100">
                    <div class="card-header bg-light py-2">
                      <h6 class="mb-0 small">Estudiantes Recientes</h6>
                    </div>
                    <div class="card-body py-2">
                      {% for estudiante in estudiantes_recientes|slice:":3" %}
                      <div class="small mb-1">
                        <strong>{{ estudiante.get_nombre_completo|truncatechars:18 }}</strong>
                        {% if estudiante.cursos.exists %}
                          <br><small class="text-muted">{{ estudiante.cursos.first.get_nivel_display }}{{ estudiante.cursos.first.paralelo }}</small>
                        {% endif %}
                      </div>
                      {% if not forloop.last %}<hr class="my-1">{% endif %}
                      {% endfor %}
                    </div>
                  </div>
                </div>
                {% endif %}
              </div>
            </div>

            {% else %}
            <div class="alert alert-warning">
              <i class="fas fa-exclamation-triangle me-2"></i>{{ error_admin }}
            </div>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Panel lateral -->
      <div class="col-lg-4 mb-4">
        <!-- Próximos eventos -->
        <div class="card border-0 shadow-sm mb-3">
          <div class="card-header bg-light border-0">
            <h6 class="mb-0">
              <i class="fas fa-calendar-alt text-warning me-2"></i>Próximos Eventos
            </h6>
          </div>
          <div class="card-body">
            {% if proximos_eventos %}
              {% for evento in proximos_eventos %}
              <div class="d-flex mb-2 p-2 rounded admin-item {% if not forloop.last %}border-bottom pb-3{% endif %}">
                <div class="me-2">
                  {% if evento.tipo_evento == 'evaluacion' %}
                    <i class="fas fa-clipboard-check text-warning"></i>
                  {% elif evento.tipo_evento == 'evento_especial' %}
                    <i class="fas fa-star text-success"></i>
                  {% else %}
                    <i class="fas fa-calendar text-info"></i>
                  {% endif %}
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-1 small">{{ evento.titulo|truncatechars:25 }}</h6>
                  <p class="mb-0 small text-muted">{{ evento.descripcion|truncatechars:50 }}</p>
                  <small class="text-muted">{{ evento.fecha|date:"d/m/Y" }}</small>
                </div>
              </div>
              {% endfor %}
              <div class="text-center mt-2">
                <a href="{% url 'calendario' %}" class="btn btn-outline-warning btn-sm">
                  <i class="fas fa-eye me-1"></i>Ver Calendario
                </a>
              </div>
            {% else %}
              <div class="text-center text-muted">
                <i class="fas fa-calendar fa-2x mb-2"></i>
                <p class="mb-0 small">No hay eventos próximos</p>
              </div>
            {% endif %}
          </div>
        </div>

        <!-- Anotaciones recientes del sistema -->
        <div class="card border-0 shadow-sm">
          <div class="card-header bg-light border-0">
            <h6 class="mb-0">
              <i class="fas fa-comments text-info me-2"></i>Anotaciones Recientes
            </h6>
          </div>
          <div class="card-body">
            {% if anotaciones_recientes_sistema %}
              {% for anotacion in anotaciones_recientes_sistema|slice:":4" %}
              <div class="d-flex mb-2 p-2 rounded admin-item {% if not forloop.last %}border-bottom pb-3{% endif %}">
                <div class="me-2">
                  {% if anotacion.tipo == 'positiva' %}
                    <i class="fas fa-thumbs-up text-success"></i>
                  {% elif anotacion.tipo == 'negativa' %}
                    <i class="fas fa-thumbs-down text-danger"></i>
                  {% else %}
                    <i class="fas fa-minus text-warning"></i>
                  {% endif %}
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-1 small">
                    {% if anotacion.estudiante %}
                      {{ anotacion.estudiante.get_nombre_completo|truncatechars:20 }}
                    {% else %}
                      {{ anotacion.curso.get_nivel_display }}{{ anotacion.curso.paralelo }} (General)
                    {% endif %}
                  </h6>
                  <p class="mb-0 small text-muted">{{ anotacion.contenido|truncatechars:45 }}</p>
                  <small class="text-muted">Por {{ anotacion.profesor_autor.get_nombre_completo|truncatechars:15 }}</small>
                </div>
              </div>
              {% endfor %}
              <div class="text-center mt-2">
                <a href="{% url 'libro_anotaciones' %}" class="btn btn-outline-info btn-sm">
                  <i class="fas fa-eye me-1"></i>Ver Todas
                </a>
              </div>
            {% else %}
              <div class="text-center text-muted">
                <i class="fas fa-clipboard fa-2x mb-2"></i>
                <p class="mb-0 small">No hay anotaciones recientes</p>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    {% else %}
    <!-- ################################################## -->
    <!-- ####### VISTA NORMAL PARA OTROS USUARIOS ######### -->
    <!-- ################################################## -->

    <!-- Panel de accesos rápidos para NO estudiantes -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card border">
          <div class="card-header bg-light border-bottom">
            <h4 class="mb-0 text-dark">
              <i class="fas fa-rocket text-primary me-2"></i>Accesos Rápidos
            </h4>
          </div>
          <div class="card-body bg-white">
            <div class="row g-3">
              {% if user.perfil.tipo_usuario == 'administrador' %}
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'listar_estudiantes' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-users fa-2x text-primary mb-2"></i>
                      <h6 class="mb-0">Gestionar Estudiantes</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'listar_estudiantes' %}?tipo=profesor" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-chalkboard-teacher fa-2x text-success mb-2"></i>
                      <h6 class="mb-0">Gestionar Profesores</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'listar_cursos' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-school fa-2x text-warning mb-2"></i>
                      <h6 class="mb-0">Gestionar Cursos</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'listar_asignaturas' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-book fa-2x text-info mb-2"></i>
                      <h6 class="mb-0">Gestionar Asignaturas</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'agregar' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-user-plus fa-2x text-danger mb-2"></i>
                      <h6 class="mb-0">Agregar Usuario</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'calendario' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-calendar-check fa-2x text-secondary mb-2"></i>
                      <h6 class="mb-0">Calendario</h6>
                    </div>
                  </a>
                </div>
              {% elif user.perfil.tipo_usuario == 'profesor' %}
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'mis_horarios' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-clock fa-2x text-primary mb-2"></i>
                      <h6 class="mb-0">Mis Horarios</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'ingresar_notas' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-edit fa-2x text-success mb-2"></i>
                      <h6 class="mb-0">Ingresar Notas</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'registrar_asistencia_alumno' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-user-check fa-2x text-warning mb-2"></i>
                      <h6 class="mb-0">Registrar Asistencia</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'listar_asignaturas' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-book-open fa-2x text-info mb-2"></i>
                      <h6 class="mb-0">Mis Asignaturas</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'ver_notas_curso' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-chart-bar fa-2x text-danger mb-2"></i>
                      <h6 class="mb-0">Ver Calificaciones</h6>
                    </div>
                  </a>
                </div>
                <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                  <a href="{% url 'calendario' %}" class="quick-access-link text-decoration-none">
                    <div class="quick-access-card text-center p-3 rounded-3 h-100">
                      <i class="fas fa-calendar-alt fa-2x text-secondary mb-2"></i>
                      <h6 class="mb-0">Calendario</h6>
                    </div>
                  </a>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Panel de información del sistema para NO estudiantes -->
    <div class="row">
      <!-- Panel principal específico por usuario -->
      <div class="col-lg-8 mb-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-light border-0">
            <h5 class="mb-0">
              <i class="fas fa-info-circle text-primary me-2"></i>Panel de Control
            </h5>
          </div>
          <div class="card-body">
            {% if user.perfil.tipo_usuario == 'profesor' %}
              <!-- PANEL ESPECÍFICO PARA PROFESORES -->
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="info-item">
                    <h6 class="text-muted mb-1">
                      <i class="fas fa-user me-1"></i>Profesor
                    </h6>
                    <p class="mb-0 fw-semibold">{{ user.get_full_name|default:user.username }}</p>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="info-item">
                    <h6 class="text-muted mb-1">
                      <i class="fas fa-envelope me-1"></i>Email
                    </h6>
                    <p class="mb-0 fw-semibold">{{ user.email|default:"No registrado" }}</p>
                  </div>
                </div>
                {% if profesor %}
                <div class="col-md-6">
                  <div class="info-item">
                    <h6 class="text-muted mb-1">
                      <i class="fas fa-chalkboard me-1"></i>Cursos como Jefe
                    </h6>
                    <p class="mb-0 fw-semibold">{{ cursos_jefe.count }} curso{{ cursos_jefe.count|pluralize:",s" }}</p>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="info-item">
                    <h6 class="text-muted mb-1">
                      <i class="fas fa-book me-1"></i>Asignaturas
                    </h6>
                    <p class="mb-0 fw-semibold">{{ cursos_asignaturas.count }} asignatura{{ cursos_asignaturas.count|pluralize:",s" }}</p>
                  </div>
                </div>
                {% endif %}
              </div>
            {% else %}
              <!-- PANEL GENÉRICO PARA ADMINISTRADORES Y DIRECTORES -->
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="info-item">
                    <h6 class="text-muted mb-1">
                      <i class="fas fa-user me-1"></i>Usuario Activo
                    </h6>
                    <p class="mb-0 fw-semibold">{{ user.get_full_name|default:user.username }}</p>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="info-item">
                    <h6 class="text-muted mb-1">
                      <i class="fas fa-envelope me-1"></i>Email
                    </h6>
                    <p class="mb-0 fw-semibold">{{ user.email|default:"No registrado" }}</p>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="info-item">
                    <h6 class="text-muted mb-1">
                      <i class="fas fa-calendar me-1"></i>Miembro desde
                    </h6>
                    <p class="mb-0 fw-semibold">{{ user.date_joined|date:"d/m/Y" }}</p>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="info-item">
                    <h6 class="text-muted mb-1">
                      <i class="fas fa-clock me-1"></i>Último acceso
                    </h6>
                    <p class="mb-0 fw-semibold">{{ user.last_login|date:"d/m/Y H:i"|default:"Primer acceso" }}</p>
                  </div>
                </div>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
      
      <div class="col-lg-4 mb-4">
        <!-- PANEL DE ANUNCIOS PARA NO ESTUDIANTES -->
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-light border-0">
            <h5 class="mb-0">
              <i class="fas fa-bullhorn text-warning me-2"></i>Anuncios del Sistema
            </h5>
          </div>
          <div class="card-body">
            <div class="alert alert-info border-0 mb-3">
              <div class="d-flex">
                <i class="fas fa-info-circle me-2 mt-1"></i>
                <div>
                  <h6 class="alert-heading mb-1">Sistema Actualizado</h6>
                  <p class="mb-0 small">Nueva versión del sistema con mejoras de rendimiento.</p>
                </div>
              </div>
            </div>
            
            <div class="alert alert-success border-0 mb-0">
              <div class="d-flex">
                <i class="fas fa-check-circle me-2 mt-1"></i>
                <div>
                  <h6 class="alert-heading mb-1">Sistema Operativo</h6>
                  <p class="mb-0 small">Todos los servicios funcionando correctamente.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Panel de permisos y funcionalidades para NO estudiantes -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card border-0 shadow-sm">
          <div class="card-header bg-light border-0">
            <h5 class="mb-0">
              <i class="fas fa-shield-alt text-primary me-2"></i>Permisos y Funcionalidades
            </h5>
          </div>
          <div class="card-body">
            {% if user.perfil.tipo_usuario == 'administrador' %}
              <div class="alert alert-danger border-0 mb-3">
                <div class="d-flex align-items-center">
                  <i class="fas fa-crown fa-2x text-danger me-3"></i>
                  <div>
                    <h6 class="alert-heading mb-1">Acceso de Administrador</h6>
                    <p class="mb-0">Tienes acceso completo a todas las funcionalidades del sistema.</p>
                  </div>
                </div>
              </div>
              <div class="row g-3">
                <div class="col-md-6">
                  <h6 class="text-success"><i class="fas fa-check me-1"></i> Gestión de Usuarios</h6>
                  <ul class="list-unstyled ms-3">
                    <li><i class="fas fa-user-plus text-primary me-1"></i> Crear estudiantes y profesores</li>
                    <li><i class="fas fa-user-edit text-warning me-1"></i> Modificar información de usuarios</li>
                    <li><i class="fas fa-user-times text-danger me-1"></i> Eliminar usuarios del sistema</li>
                  </ul>
                </div>
                <div class="col-md-6">
                  <h6 class="text-success"><i class="fas fa-check me-1"></i> Gestión Académica</h6>
                  <ul class="list-unstyled ms-3">
                    <li><i class="fas fa-chalkboard text-info me-1"></i> Crear y gestionar cursos</li>
                    <li><i class="fas fa-book text-success me-1"></i> Administrar asignaturas</li>
                    <li><i class="fas fa-calendar-alt text-warning me-1"></i> Gestionar horarios y eventos</li>
                  </ul>
                </div>
                <div class="col-md-6">
                  <h6 class="text-success"><i class="fas fa-check me-1"></i> Control de Notas</h6>
                  <ul class="list-unstyled ms-3">
                    <li><i class="fas fa-edit text-primary me-1"></i> Ingresar y modificar calificaciones</li>
                    <li><i class="fas fa-chart-bar text-info me-1"></i> Generar reportes académicos</li>
                  </ul>
                </div>
                <div class="col-md-6">
                  <h6 class="text-success"><i class="fas fa-check me-1"></i> Control de Asistencia</h6>
                  <ul class="list-unstyled ms-3">
                    <li><i class="fas fa-clipboard-check text-success me-1"></i> Registrar asistencia de estudiantes</li>
                    <li><i class="fas fa-user-check text-warning me-1"></i> Controlar asistencia de profesores</li>
                  </ul>
                </div>
              </div>
            {% elif user.perfil.tipo_usuario == 'profesor' %}
              <div class="alert alert-warning border-0 mb-3">
                <div class="d-flex align-items-center">
                  <i class="fas fa-chalkboard-teacher fa-2x text-warning me-3"></i>
                  <div>
                    <h6 class="alert-heading mb-1">Acceso de Profesor</h6>
                    <p class="mb-0">Puedes gestionar las actividades académicas de tus cursos asignados.</p>
                  </div>
                </div>
              </div>
              <div class="row g-3">
                <div class="col-md-6">
                  <h6 class="text-success"><i class="fas fa-check me-1"></i> Gestión de Clases</h6>
                  <ul class="list-unstyled ms-3">
                    <li><i class="fas fa-clock text-primary me-1"></i> Ver horarios de clases</li>
                    <li><i class="fas fa-book-open text-info me-1"></i> Gestionar asignaturas asignadas</li>
                    <li><i class="fas fa-calendar-plus text-success me-1"></i> Crear eventos académicos</li>
                  </ul>
                </div>
                <div class="col-md-6">
                  <h6 class="text-success"><i class="fas fa-check me-1"></i> Evaluaciones</h6>
                  <ul class="list-unstyled ms-3">
                    <li><i class="fas fa-edit text-warning me-1"></i> Ingresar calificaciones</li>
                    <li><i class="fas fa-chart-line text-info me-1"></i> Ver reportes de notas</li>
                    <li><i class="fas fa-clipboard-check text-success me-1"></i> Tomar asistencia</li>
                  </ul>
                </div>
                <div class="col-md-12">
                  <h6 class="text-danger"><i class="fas fa-times me-1"></i> Restricciones</h6>
                  <ul class="list-unstyled ms-3">
                    <li><i class="fas fa-ban text-danger me-1"></i> No puede crear o eliminar usuarios</li>
                    <li><i class="fas fa-ban text-danger me-1"></i> No puede modificar cursos o asignaturas de otros profesores</li>
                  </ul>
                </div>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Actualizar fecha y hora actual
  function updateDateTime() {
    const now = new Date();
    const options = { 
      weekday: 'long', 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    };
    document.getElementById('currentDateTime').textContent = now.toLocaleDateString('es-ES', options);
  }
  
  updateDateTime();
  setInterval(updateDateTime, 60000); // Actualizar cada minuto
  
  // Animación de entrada para las tarjetas de estadísticas
  const statsCards = document.querySelectorAll('.stats-card');
  statsCards.forEach((card, index) => {
    card.style.opacity = '0';
    card.style.transform = 'translateY(20px)';
    
    setTimeout(() => {
      card.style.transition = 'all 0.6s ease';
      card.style.opacity = '1';
      card.style.transform = 'translateY(0)';
    }, index * 150);
  });
  
  // Animación de entrada para accesos rápidos
  const quickAccessCards = document.querySelectorAll('.quick-access-card');
  quickAccessCards.forEach((card, index) => {
    card.style.opacity = '0';
    card.style.transform = 'scale(0.9)';
    
    setTimeout(() => {
      card.style.transition = 'all 0.4s ease';
      card.style.opacity = '1';
      card.style.transform = 'scale(1)';
    }, 600 + (index * 100));
  });
});
</script>
    {% endif %}
  </div>
</div>
{% endblock %}